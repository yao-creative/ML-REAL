in mathematics, the spectral theory of ordinary differential equations is the part of spectral theory concerned with the determination of the spectrum and eigenfunction expansion associated with a linear ordinary differential equation. in his dissertation hermann weyl generalized the classical sturm–liouville theory on a finite closed interval to second order differential operators with singularities at the endpoints of the interval, possibly semi-infinite or infinite. unlike the classical case, the spectrum may no longer consist of just a countable set of eigenvalues, but may also contain a continuous part. in this case the eigenfunction expansion involves an integral over the continuous part with respect to a spectral measure, given by the titchmarsh–kodaira formula. the theory was put in its final simplified form for singular differential equations of even degree by kodaira and others, using von neumann's spectral theorem. it has had important applications in quantum mechanics, operator theory and harmonic analysis on semisimple lie groups.


== introduction ==
spectral theory for second order ordinary differential equations on a compact interval was developed by jacques charles françois sturm and joseph liouville in the nineteenth century and is now known as sturm–liouville theory. in modern language it is an application of the spectral theorem for compact operators due to david hilbert. in his dissertation, published in 1910, hermann weyl extended this theory to second order ordinary differential equations with
singularities at the endpoints of the interval, now allowed to be infinite or semi-infinite. he simultaneously developed a spectral theory adapted to these special operators and introduced boundary conditions in terms of his celebrated dichotomy between limit points and limit circles.
in the 1920s john von neumann established a general spectral theorem for unbounded self-adjoint operators, which kunihiko kodaira used to streamline weyl's method. kodaira also generalised weyl's method to singular ordinary differential equations of even order and obtained a simple formula for the spectral measure. the same formula had also been obtained independently by e. c. titchmarsh in 1946 (scientific communication between japan and the united kingdom had been interrupted by world war ii). titchmarsh had followed the method of the german mathematician emil hilb, who derived the eigenfunction expansions using complex function theory instead of operator theory. other methods avoiding the spectral theorem were later developed independently by levitan, levinson and yoshida, who used the fact that the resolvent of the singular differential operator could be approximated by compact resolvents corresponding to sturm–liouville problems for proper subintervals. another method was found by mark grigoryevich krein; his use of direction functionals was subsequently generalised by izrail glazman to arbitrary ordinary differential equations of even order.
weyl applied his theory to carl friedrich gauss's hypergeometric differential equation, thus obtaining a far-reaching generalisation of the transform formula of gustav ferdinand mehler (1881) for the legendre differential equation, rediscovered by the russian physicist vladimir fock in 1943, and usually called the mehler–fock transform. the corresponding ordinary differential operator is the radial part of the laplacian operator on 2-dimensional hyperbolic space. more generally, the plancherel theorem for sl(2,r) of harish chandra and gelfand–naimark can be deduced from weyl's theory for the hypergeometric equation, as can the theory of spherical functions for the isometry groups of higher dimensional hyperbolic spaces. harish chandra's later development of the plancherel theorem for general real semisimple lie groups was strongly influenced by the methods weyl developed for eigenfunction expansions associated with singular ordinary differential equations. equally importantly the theory also laid the mathematical foundations for the analysis of the schrödinger equation and scattering matrix in quantum mechanics.


== solutions of ordinary differential equations ==


=== reduction to standard form ===
let d be the second order differential operator on (a,b) given by

where p is a strictly positive continuously differentiable function and q and r are continuous
real-valued functions.
for x0 in (a, b), define the liouville transformation ψ by

if

is the unitary operator defined by

then

and

hence,

where

and

the term in g'  can be removed using an euler integrating factor. if s' /s = −r/2, then h = sg satisfies

where the potential v is given by

the differential operator can thus always be reduced to one of the form 


=== existence theorem ===
the following is a version of the classical picard existence theorem for second order differential equations with values in a 
banach space e.let α, β be arbitrary elements of e, a a bounded operator on e and q a continuous function on [a, b].
then, for c = a or b, the differential equation

df = afhas a unique solution f in c2([a,b],e) satisfying the initial conditions

f(c) = β, f '(c) = α.in fact a solution of the differential equation with these initial conditions is equivalent to a solution
of the integral equation

f = h + t fwith t the bounded linear map on c([a,b], e) defined by

where k is the volterra kernel

k(x,t)= (x − t)(q(t) − a)and

h(x) = α(x − c) + β.since ||tk|| tends to 0, this integral equation has a unique solution given by the neumann series

f = (i − t)−1 h = h  + t h + t2 h + t3 h + ⋯this iterative scheme is often called picard iteration after the french mathematician charles émile picard.


=== fundamental eigenfunctions ===
if f is twice continuously differentiable (i.e. c2) on (a, b) satisfying df = λf, then f is called an eigenfunction of l with eigenvalue λ.

in the case of a compact interval [a, b] and q continuous on [a, b], the existence theorem implies that for c = a or b and every complex number λ there a unique c2 eigenfunction fλ  on [a, b] with fλ(c) and f 'λ(c) prescribed. moreover, for each x in [a, b], fλ(x) and f 'λ(x) are holomorphic functions of λ.
for an arbitrary interval (a,b) and q continuous on (a, b), the existence theorem implies that for c in (a, b)  and every complex number λ there a unique c2 eigenfunction fλ  on (a, b) with fλ(c) and f 'λ(c) prescribed. moreover, for each x in (a, b), fλ(x) and f 'λ(x) are holomorphic functions of λ.


=== green's formula ===
if f and g are c2 functions on (a, b),  the wronskian w(f, g) is defined by

w(f, g) (x) = f(x) g '(x) − f '(x) g(x).green's formula - which in this one-dimensional case is a simple integration by parts - states that for x, y in (a, b)

when q is continuous and f, g c2 on the compact interval [a, b], this formula also holds for x = a or y = b.
when f and g are eigenfunctions for the same eigenvalue, then

so that w(f, g) is independent of x.


== classical sturm–liouville theory ==

let [a, b] be a finite closed interval, q a real-valued continuous function on [a, b] and let h0 be the
space of c2 functions f on [a, b] satisfying the robin boundary conditions

with inner product

in practise usually one of the two standard boundary conditions:

dirichlet boundary condition f(c) = 0
neumann boundary condition f '(c) = 0is imposed at each endpoint c = a, b.
the differential operator d given by

acts on h0. a function f in h0 is called an eigenfunction of d (for the above choice of boundary values) if df = λ f for some complex number λ, the corresponding eigenvalue.
by green's formula, d is formally self-adjoint on h0, since the wronskian w(f,g) vanishes if both f,g satisfy the  boundary conditions:

(df, g) = (f, dg) for f, g in h0.as a consequence, exactly as for a self-adjoint matrix in finite dimensions,

the eigenvalues of d are real;
the eigenspaces for distinct eigenvalues are orthogonal.it turns out that the eigenvalues can be described by the maximum-minimum principle of rayleigh–ritz (see below). in fact it is easy to see a priori that the eigenvalues are bounded below because the operator d is itself bounded below on h0:

  
    
      
        (
        d
        f
        ,
        f
        )
        ≥
        m
        (
        f
        ,
        f
        )
      
    
    {\displaystyle (df,f)\geq m(f,f)}
   for some finite (possibly negative) constant 
  
    
      
        m
      
    
    {\displaystyle m}
  .in fact integrating by parts

for dirichlet or neumann boundary conditions, the first term vanishes and the inequality holds with m = inf q.
for general robin boundary conditions the first term can be estimated using an elementary peter-paul version of sobolev's inequality:

"given ε > 0, there is constant r >0 such that |f(x)|2 ≤ ε (f', f') + r (f, f) for all f in c1[a, b]."in fact, since

|f(b) − f(x)| ≤ (b − a)1/2·||f '||2,only an estimate for f(b) is needed and this follows by replacing f(x) in the above inequality by (x − a)n·(b − a)−n·f(x) for n sufficiently large.


=== green's function (regular case) ===
from the theory of ordinary differential equations, there are unique fundamental eigenfunctions φλ(x), χλ(x) such that

d φλ = λ φλ,  φλ(a) = sin α,  φλ'(a) =  cos α
d χλ = λ χλ,   χλ(b) = sin β,   χλ'(b) =  cos βwhich at each point, together with their first derivatives, depend holomorphically on λ. let

ω(λ) = w(φλ, χλ),be an entire holomorphic function.
this function ω(λ) plays the rôle of the characteristic polynomial of d. indeed, the uniqueness of the fundamental eigenfunctions implies that its zeros are precisely the eigenvalues of d and that each non-zero eigenspace is one-dimensional. in particular there are at most countably many eigenvalues of d and, if there are infinitely many, they must tend to infinity. it turns out that the zeros of ω(λ) also have mutilplicity one (see below).
if λ is not an eigenvalue of d on h0, define the green's function by

gλ(x,y) = φλ (x)  χλ(y) / ω(λ) for x ≥ y and χλ(x) φλ (y) / ω(λ) for y ≥ x.this kernel defines an operator on the inner product space c[a,b] via

since gλ(x,y) is continuous on [a, b] x [a, b], it defines a hilbert–schmidt operator on the hilbert space completion
h of c[a, b] = h1 (or equivalently of the dense subspace h0), taking values in h1. this operator carries h1 into h0. when λ is real, gλ(x,y) = gλ(y,x) is also real, so defines a self-adjoint operator on h. moreover,

gλ (d − λ) =i on h0
gλ carries h1 into h0, and  (d − λ) gλ = i on h1.thus the operator gλ can be identified with the resolvent (d − λ)−1.


=== spectral theorem ===
theorem. the eigenvalues of d are real of multiplicity one and form an increasing sequence λ1 < λ2 < ··· tending to infinity.
the corresponding normalised eigenfunctions form an orthonormal basis of h0.
the kth eigenvalue of d is given by the minimax principle

in particular if q1 ≤ q2, then

in fact let t = gλ for λ large and negative. then t defines a compact self-adjoint operator on the hilbert space h.
by the spectral theorem for compact self-adjoint operators, h has an orthonormal basis consisting of eigenvectors ψn of t with
tψn =  μn ψn, where μn tends to zero. the range of t contains h0 so is dense. hence 0 is not an eigenvalue of t. the resolvent properties of t imply that ψn lies in h0 and that

d ψn = (λ + 1/μn) ψnthe minimax principle follows because if

then λ(g)= λk for the linear span of the first k − 1 eigenfunctions. for any other (k − 1)-dimensional subspace g, some f in the linear span of the first k eigenvectors must be orthogonal to g. hence λ(g) ≤ (df,f)/(f,f) ≤ λk.


=== wronskian as a fredholm determinant ===
for simplicity, suppose that m ≤ q(x) ≤ m on [0,π] with dirichlet boundary conditions.
the minimax principle shows that

it follows that the resolvent (d − λ)−1 is a trace-class operator whenever λ is not an eigenvalue of d and hence that the fredholm determinant det i − μ(d − λ)−1 is defined.
the dirichlet boundary conditions imply that

ω(λ)= φλ(b).using picard iteration, titchmarsh showed that φλ(b), and hence ω(λ), is an entire function of finite order 1/2:

ω(λ) = o(e√|λ|)at a zero μ of ω(λ), φμ(b) = 0. moreover,

satisfies (d − μ)ψ = φμ. thus

ω(λ) = (λ − μ)ψ(b) + o( (λ − μ)2).this implies that
μ is a simple zero of ω(λ).for otherwise ψ(b) = 0, so that ψ would have to lie in h0.
but then

(φμ, φμ) = ((d − μ)ψ, φμ) = (ψ, (d − μ)φμ) = 0,a contradiction.
on the other hand, the distribution of the zeros of the entire function
ω(λ) is already known from the minimax principle.
by the hadamard factorization theorem, it follows
that

  
    
      
        ω
        (
        λ
        )
        =
        c
        ∏
        (
        1
        −
        λ
        
          /
        
        
          λ
          
            n
          
        
        )
        ,
      
    
    {\displaystyle \omega (\lambda )=c\prod (1-\lambda /\lambda _{n}),}
  for some non-zero constant c.
hence

in particular if 0 is not an eigenvalue of d


== tools from abstract spectral theory ==


=== functions of bounded variation ===

a function ρ(x) of bounded variation on a closed interval [a, b] is a complex-valued function such that  
its total variation v(ρ), the supremum
of the variations

over all dissections

is finite. the real and imaginary parts of ρ are real-valued functions of bounded variation. if ρ is real-valued and normalised so that ρ(a)=0, it has a canonical decomposition as the difference of two bounded non-decreasing functions:

where ρ+(x) and ρ–(x) are the total positive and negative variation of ρ over [a, x].
if f is a continuous function on [a, b] its riemann–stieltjes integral with respect to ρ

is defined to be the limit of approximating sums

as the mesh of the dissection, given by sup |xr+1 - xr|, tends to zero.
this integral satisfies

and thus defines a bounded linear functional dρ on c[a, b] with norm  ||dρ||=v(ρ).
every bounded linear functional μ on c[a, b] has an absolute value |μ| defined for non-negative f by
the form |μ| extends linearly to a bounded linear form on c[a, b] with norm ||μ|| and satisfies the characterizing inequality

|μ(f)| ≤ |μ|(|f|)for f in c[a, b]. if μ is real, i.e. is real-valued on real-valued functions, then

gives a canonical decomposition as a difference of positive forms, i.e. forms that are non-negative on non-negative functions.
every positive form μ extends uniquely to the linear span of non-negative bounded lower semicontinuous functions g by the formula
where the non-negative continuous functions fn increase pointwise to g.
the same therefore applies to an arbitrary bounded linear form μ, so that a function ρ of bounded variation may be defined by
where χa denotes the characteristic function of a subset a of [a, b]. thus μ = dρ and ||μ|| = ||dρ||.
moreover μ+ = dρ+ and μ– = dρ–.
this correspondence between functions of bounded variation and bounded linear forms is a special case of the riesz representation theorem.
the support of μ = dρ is the complement of all points x in [a,b] where ρ is constant on some neighborhood of x; by definition it is a closed subset a of [a,b]. moreover, μ((1-χa)f) =0, so that μ(f) = 0 if f vanishes on a.


=== spectral measure ===

let h be a hilbert space and 
  
    
      
        t
      
    
    {\displaystyle t}
   a self-adjoint bounded operator on h with 
  
    
      
        0
        ≤
        t
        ≤
        i
      
    
    {\displaystyle 0\leq t\leq i}
  , so that the spectrum 
  
    
      
        σ
        (
        t
        )
      
    
    {\displaystyle \sigma (t)}
   of 
  
    
      
        t
      
    
    {\displaystyle t}
   is contained in 
  
    
      
        [
        0
        ,
        1
        ]
      
    
    {\displaystyle [0,1]}
  . if 
  
    
      
        p
        (
        t
        )
      
    
    {\displaystyle p(t)}
   is a complex polynomial, then by the spectral mapping theorem

and hence

where 
  
    
      
        ‖
        
        
          ‖
          
            ∞
          
        
      
    
    {\displaystyle \|\,\|_{\infty }}
   denotes the uniform norm on 
  
    
      
        c
        [
        0
        ,
        1
        ]
      
    
    {\displaystyle c[0,1]}
  .  by the weierstrass approximation theorem, polynomials are uniformly dense in 
  
    
      
        c
        [
        0
        ,
        1
        ]
      
    
    {\displaystyle c[0,1]}
  . it follows that 
  
    
      
        f
        (
        t
        )
      
    
    {\displaystyle f(t)}
   can be defined 
  
    
      
        ∀
        f
        ∈
        c
        [
        0
        ,
        1
        ]
      
    
    {\displaystyle \forall f\in c[0,1]}
  , with
 and 
  
    
      
        ‖
        f
        (
        t
        )
        ‖
        ≤
        ‖
        f
        
          ‖
          
            ∞
          
        
      
    
    {\displaystyle \|f(t)\|\leq \|f\|_{\infty }}
  .
if  
  
    
      
        0
        ≤
        g
        ≤
        1
      
    
    {\displaystyle 0\leq g\leq 1}
    is a lower semicontinuous function on 
  
    
      
        [
        0
        ,
        1
        ]
      
    
    {\displaystyle [0,1]}
  , for example the characteristic function 
  
    
      
        
          χ
          
            [
            0
            ,
            α
            ]
          
        
      
    
    {\displaystyle \chi _{[0,\alpha ]}}
   of a subinterval of 
  
    
      
        [
        0
        ,
        1
        ]
      
    
    {\displaystyle [0,1]}
  , then

  
    
      
        g
      
    
    {\displaystyle g}
   is a pointwise increasing limit of non-negative 
  
    
      
        
          f
          
            n
          
        
        ∈
        c
        [
        0
        ,
        1
        ]
      
    
    {\displaystyle f_{n}\in c[0,1]}
  .
according to szőkefalvi-nagy, if 
  
    
      
        ξ
      
    
    {\displaystyle \xi }
   is a vector in h, then the vectors

form a cauchy sequence in h, since, for 
  
    
      
        n
        ≥
        m
      
    
    {\displaystyle n\geq m}
  ,

and 
  
    
      
        (
        
          η
          
            n
          
        
        ,
        ξ
        )
        =
        (
        
          f
          
            n
          
        
        (
        t
        )
        ξ
        ,
        ξ
        )
      
    
    {\displaystyle (\eta _{n},\xi )=(f_{n}(t)\xi ,\xi )}
   is bounded and increasing, so has a limit.
it follows that 
  
    
      
        g
        (
        t
        )
      
    
    {\displaystyle g(t)}
   can be defined by
if 
  
    
      
        ξ
      
    
    {\displaystyle \xi }
   and 
  
    
      
        η
      
    
    {\displaystyle \eta }
   are vectors in h, then

defines a bounded linear form 
  
    
      
        
          μ
          
            ξ
            ,
            η
          
        
      
    
    {\displaystyle \mu _{\xi ,\eta }}
   on h. by the riesz representation theorem

for a unique normalised function 
  
    
      
        
          ρ
          
            ξ
            ,
            η
          
        
      
    
    {\displaystyle \rho _{\xi ,\eta }}
   of bounded variation on 
  
    
      
        [
        0
        ,
        1
        ]
      
    
    {\displaystyle [0,1]}
  .

  
    
      
        d
        
          ρ
          
            ξ
            ,
            η
          
        
      
    
    {\displaystyle d\rho _{\xi ,\eta }}
   (or sometimes slightly incorrectly 
  
    
      
        
          ρ
          
            ξ
            ,
            η
          
        
      
    
    {\displaystyle \rho _{\xi ,\eta }}
   itself) is called the spectral measure
determined by 
  
    
      
        ξ
      
    
    {\displaystyle \xi }
   and 
  
    
      
        η
      
    
    {\displaystyle \eta }
  .
the operator 
  
    
      
        g
        (
        t
        )
      
    
    {\displaystyle g(t)}
   is accordingly uniquely characterised by the equation

the spectral projection 
  
    
      
        e
        (
        λ
        )
      
    
    {\displaystyle e(\lambda )}
   is defined by

so that

it follows that

which is understood in the sense that for any vectors 
  
    
      
        ξ
      
    
    {\displaystyle \xi }
   and 
  
    
      
        η
      
    
    {\displaystyle \eta }
  ,

for a single vector 
  
    
      
        ξ
        ,
        
        
          μ
          
            ξ
          
        
        =
        
          μ
          
            ξ
            ,
            ξ
          
        
      
    
    {\displaystyle \xi ,\,\mu _{\xi }=\mu _{\xi ,\xi }}
   is a positive form on 
  
    
      
        [
        0
        ,
        1
        ]
      
    
    {\displaystyle [0,1]}
   
(in other words proportional to a probability measure on 
  
    
      
        [
        0
        ,
        1
        ]
      
    
    {\displaystyle [0,1]}
  ) and 
  
    
      
        
          ρ
          
            ξ
          
        
        =
        
          ρ
          
            ξ
            ,
            ξ
          
        
      
    
    {\displaystyle \rho _{\xi }=\rho _{\xi ,\xi }}
   is non-negative and non-decreasing.
polarisation shows that all the forms 
  
    
      
        
          μ
          
            ξ
            ,
            η
          
        
      
    
    {\displaystyle \mu _{\xi ,\eta }}
   can naturally be expressed in terms of such positive forms, since

if the vector 
  
    
      
        ξ
      
    
    {\displaystyle \xi }
   is such that the linear span of the vectors 
  
    
      
        (
        
          t
          
            n
          
        
        ξ
        )
      
    
    {\displaystyle (t^{n}\xi )}
   is dense in h, i.e. 
  
    
      
        ξ
      
    
    {\displaystyle \xi }
   is a cyclic vector for 
  
    
      
        t
      
    
    {\displaystyle t}
  , then the map 
  
    
      
        u
      
    
    {\displaystyle u}
   defined by

satisfies

let 
  
    
      
        
          l
          
            2
          
        
        (
        [
        0
        ,
        1
        ]
        ,
        d
        
          ρ
          
            ξ
          
        
        )
      
    
    {\displaystyle l_{2}([0,1],d\rho _{\xi })}
   denote the hilbert space completion of 
  
    
      
        c
        [
        0
        ,
        1
        ]
      
    
    {\displaystyle c[0,1]}
   associated
with the possibly degenerate inner product on the right hand side. 
thus 
  
    
      
        u
      
    
    {\displaystyle u}
   extends to a unitary transformation of 
  
    
      
        
          l
          
            2
          
        
        (
        [
        0
        ,
        1
        ]
        ,
        
          ρ
          
            ξ
          
        
        )
      
    
    {\displaystyle l_{2}([0,1],\rho _{\xi })}
   onto h. 
  
    
      
        u
        t
        
          u
          
            ∗
          
        
      
    
    {\displaystyle utu^{\ast }}
   is then just multiplication by 
  
    
      
        λ
      
    
    {\displaystyle \lambda }
   on 
  
    
      
        
          l
          
            2
          
        
        (
        [
        0
        ,
        1
        ]
        ,
        d
        
          ρ
          
            ξ
          
        
        )
      
    
    {\displaystyle l_{2}([0,1],d\rho _{\xi })}
  ; and more generally 
  
    
      
        u
        f
        (
        t
        )
        
          u
          
            ∗
          
        
      
    
    {\displaystyle uf(t)u^{\ast }}
   is multiplication by 
  
    
      
        f
        (
        λ
        )
      
    
    {\displaystyle f(\lambda )}
  . in this case, the support of 
  
    
      
        d
        
          ρ
          
            ξ
          
        
      
    
    {\displaystyle d\rho _{\xi }}
  
is exactly 
  
    
      
        σ
        (
        t
        )
      
    
    {\displaystyle \sigma (t)}
  , so that

the self-adjoint operator becomes a multiplication operator on the space of functions on its spectrum with inner product given by the spectral measure.


== weyl–titchmarsh–kodaira theory ==
the eigenfunction expansion associated with singular differential operators of the form

on an open interval (a, b) requires an initial analysis of the behaviour of the fundamental
eigenfunctions near the endpoints a and b to determine possible boundary conditions there. unlike the regular sturm–liouville case, in some circumstances spectral values of d can have multiplicity 2. in the development outlined below standard assumptions will be imposed on p and q that guarantee that the spectrum of
d has multiplicity one everywhere and is bounded below. this includes almost all important applications; modifications required for the more general case will be discussed later.
having chosen the boundary conditions, as in the classical theory the resolvent of d, (d + r )−1 for r  large and positive, is given by an operator t corresponding to a green's function constructed from two fundamental eigenfunctions. in the classical case t was a compact self-adjoint operator; in this case t is just a self-adjoint bounded operator with 0 ≤ t ≤ i. the abstract theory of spectral measure can therefore be applied to t to give the eigenfunction expansion for d.
the central idea in the proof of weyl and kodaira can be explained informally as follows. assume that the spectrum of d lies in [1,∞) and that t =d−1 and let

be the spectral projection of d corresponding to the interval [1,λ]. for an arbitrary function f define

f(x,λ)  may be regarded as a differentiable map into the space of functions of bounded variation ρ; or equivalently as a differentiable map

into the banach space e of  bounded linear functionals dρ on c[α,β] whenever [α,β] is a compact subinterval of [1, ∞).
weyl's fundamental observation was that dλ f  satisfies a second order ordinary differential equation taking values in e:

  
    
      
        d
        (
        
          d
          
            λ
          
        
        f
        )
        =
        λ
        ⋅
        
          d
          
            λ
          
        
        f
        .
      
    
    {\displaystyle d(d_{\lambda }f)=\lambda \cdot d_{\lambda }f.}
  after imposing initial conditions on the first two derivatives at a fixed point c, this equation can be solved explicitly
in terms of the two fundamental eigenfunctions and the "initial value" functionals

this point of view may now be turned on its head: f(c,λ) and fx(c,λ) may be written as

where ξ1(λ) and ξ2(λ) are given purely in terms of the fundamental eigenfunctions.
the functions of bounded variation

determine a spectral measure on the spectrum of d and can be computed explicitly from the behaviour of the fundamental eigenfunctions (the titchmarsh–kodaira formula).


=== limit circle and limit point for singular equations ===
let  q(x) be a continuous real-valued function on (0,∞) and let d be the second order differential operator

on (0,∞). fix a point c in (0,∞) and, for λ complex, let 
  
    
      
        
          φ
          
            λ
          
        
        ,
        
          θ
          
            λ
          
        
      
    
    {\displaystyle \varphi _{\lambda },\theta _{\lambda }}
   be the unique fundamental eigenfunctions of d on (0,∞) satisfying

together with the initial conditions at c

then their wronskian satisfies

since it is constant and equal to 1 at c.
let λ be non-real and 0 < x < ∞. if the complex number 
  
    
      
        μ
      
    
    {\displaystyle \mu }
   is such that 
  
    
      
        f
        =
        φ
        +
        μ
        θ
      
    
    {\displaystyle f=\varphi +\mu \theta }
   satisfies the boundary condition 
  
    
      
        cos
        ⁡
        β
        
        f
        (
        x
        )
        −
        sin
        ⁡
        β
        
        
          f
          ′
        
        (
        x
        )
        =
        0
      
    
    {\displaystyle \cos \beta \,f(x)-\sin \beta \,f'(x)=0}
   for some 
  
    
      
        β
      
    
    {\displaystyle \beta }
   (or, equivalently, 
  
    
      
        
          f
          ′
        
        (
        x
        )
        
          /
        
        f
        (
        x
        )
      
    
    {\displaystyle f'(x)/f(x)}
   is real) then, using integration by parts, one obtains

therefore, the set of 
  
    
      
        μ
      
    
    {\displaystyle \mu }
   satisfying this equation is not empty. this set is a circle in the complex 
  
    
      
        μ
      
    
    {\displaystyle \mu }
  -plane. points 
  
    
      
        μ
      
    
    {\displaystyle \mu }
   in its interior are characterized by

if x > c and by

if x < c.
let dx be the closed disc enclosed by the circle. by definition these closed discs are nested and decrease as x approaches 0 or ∞. so in the limit, the circles tend either to a limit circle or a limit point at each end. if 
  
    
      
        μ
      
    
    {\displaystyle \mu }
   is a limit point or a point on the limit circle at 0 or ∞, then 
  
    
      
        f
        =
        φ
        +
        μ
        θ
      
    
    {\displaystyle f=\varphi +\mu \theta }
   is square integrable (l2) near 0 or ∞, since 
  
    
      
        μ
      
    
    {\displaystyle \mu }
   lies in dx for all x>c (in the ∞ case) and so 
  
    
      
        
          ∫
          
            c
          
          
            x
          
        
        
          |
        
        φ
        +
        μ
        θ
        
          
            |
          
          
            2
          
        
        <
        
          
            
              
                
                  i
                  m
                
              
              (
              μ
              )
            
            
              
                
                  i
                  m
                
              
              (
              λ
              )
            
          
        
      
    
    {\displaystyle \int _{c}^{x}|\varphi +\mu \theta |^{2}<{{\rm {im}}(\mu ) \over {\rm {im}}(\lambda )}}
   is bounded independent of x. in particular:
there are always non-zero solutions of  df = λf  which are square integrable near 0 resp. ∞;
in the limit circle case all solutions of df = λf are square integrable near 0 resp. ∞.the radius of the disc dx can be calculated to be 

  
    
      
        
          |
          
            
              1
              
                2
                
                  
                    i
                    m
                  
                
                (
                λ
                )
                
                  ∫
                  
                    c
                  
                  
                    x
                  
                
                
                  |
                
                θ
                
                  
                    |
                  
                  
                    2
                  
                
              
            
          
          |
        
      
    
    {\displaystyle \left|{1 \over {2{\rm {im}}(\lambda )\int _{c}^{x}|\theta |^{2}}}\right|}
  and this implies that in the limit point case 
  
    
      
        θ
      
    
    {\displaystyle \theta }
   cannot be square integrable near 0 resp. ∞. therefore, we have a converse to the second statement above:

in the limit point case there is exactly one non-zero solution (up to scalar multiples) of df = λf which is square integrable near 0 resp. ∞.on the other hand, if dg = λ' g for another value λ', then

satisfies dh = λh, so that

this formula may also be obtained directly by the variation of constant method from (d-λ)g = (λ'-λ)g.
using this to estimate g, it follows that
the limit point/limit circle behaviour at 0 or ∞ is independent of the choice of λ.more generally if dg= (λ – r) g for some function r(x), then
from this it follows that
if r is continuous at 0, then d + r is limit point or limit circle at 0 precisely when d is,so that in particular
if q(x)- a/x2 is continuous at 0, then d is limit point at 0 if and only if a ≥ ¾.similarly

if r has a finite limit at ∞, then d + r is limit point or limit circle at ∞ precisely when d is,so that in particular
if q has a finite limit at ∞, then d is limit point at ∞.many more elaborate criteria to be limit point or limit circle can be found in the mathematical literature.


=== green's function (singular case) ===
consider the differential operator

on (0,∞) with q0 positive and continuous on (0,∞) and p0 continuously differentiable in [0,∞), positive in (0,∞) and p0(0)=0.
moreover, assume that after reduction to standard form
d0 becomes the equivalent operator

on (0,∞) where q has a finite limit at ∞. thus

d is limit point at ∞.at 0, d may be either limit circle or limit point. in either case there is an eigenfunction φ0 with dφ0=0 and  φ0 square integrable near 0. in the limit circle case, φ0 determines a boundary condition at 0:

for λ complex, let φλ and χλ satisfy

(d – λ)φλ = 0, (d – λ)χλ = 0
χλ square integrable near infinity
φλ square integrable at 0 if 0 is limit point
φλ satisfies the boundary condition above if 0 is limit circle.let

a constant which vanishes precisely when φλ and χλ are proportional, i.e. λ is an eigenvalue of d for these boundary conditions.
on the other hand, this cannot occur if im λ ≠ 0 or if λ is negative.indeed, if d f= λf with q0 – λ ≥ δ >0, then by green's formula (df,f) = (f,df),  since w(f,f*) is constant. so  λ must be real. if f is taken to be real-valued in the d0 realization, then for 0 < x < y

since p0(0) = 0 and f is integrable near 0, p0f f ' must vanish at 0. setting x = 0, it follows that f(y) f '(y)  >0, so that f2 is increasing, contradicting the square integrability of f near ∞.
thus, adding a positive scalar to q, it may be assumed that

ω(λ) ≠ 0 when λ is not in [1,∞).if ω(λ) ≠ 0, the green's function gλ(x,y) at λ is defined by

and is independent of the choice of λ and χλ.
in the examples there will be a third "bad" eigenfunction ψλ defined and holomorphic for λ not in [1, ∞) such that 
ψλ satisfies the boundary conditions at neither 0 nor ∞. this means that for λ not in [1, ∞)

w(φλ,ψλ) is nowhere vanishing;
w(χλ,ψλ) is nowhere vanishing.in this case χλ is proportional to φλ + m(λ) ψλ, where

m(λ) = – w(φλ,χλ) / w(ψλ,χλ).let h1 be the space of square integrable continuous functions on (0,∞) and let h0 be

the space of c2 functions f on (0,∞) of compact support if d is limit point at 0
the space of c2 functions f on (0,∞) with w(f,φ0)=0 at 0 and with f = 0 near ∞ if d is limit circle at 0.define t = g0 by

then t d = i on h0, d t = i on h1 and the operator d is bounded below on h0:

thus t is a self-adjoint bounded operator with 0 ≤ t ≤ i.
formally t = d−1. the corresponding operators gλ defined for λ not in [1,∞) can be formally identified with

and satisfy gλ (d – λ) = i on h0, (d – λ)gλ = i on h1.


=== spectral theorem and titchmarsh–kodaira formula ===
theorem. for every real number λ let ρ(λ) be defined by the titchmarsh–kodaira formula:

then ρ(λ) is a lower semicontinuous non-decreasing function of λ and if

then u defines a unitary transformation of l2(0,∞) onto l2([1,∞), dρ) such that udu−1 corresponds to multiplication by λ. 
the inverse transformation u−1 is given by

the spectrum of d equals the support of dρ.
kodaira gave a streamlined version of weyl's original proof. (m.h. stone had previously shown how part of weyl's work could be simplified using von neumann's spectral theorem.)
in fact for t =d−1 with 0 ≤ t ≤ i, the spectral projection e(λ) of t is defined by

it is also the spectral projection of d corresponding to the interval [1,λ].
for f in h1 define

f(x,λ)  may be regarded as a differentiable map into the space of functions ρ of bounded variation; or equivalently as a differentiable map

into the banach space e of  bounded linear functionals dρ on c[α,β] for any compact subinterval [α,β] of [1, ∞).
the functionals (or measures) dλ f(x)  satisfies the following e-valued second order ordinary differential equation:

with initial conditions at c in (0,∞)

if φλ and χλ are the special eigenfunctions adapted to c, then

moreover,

where

with

(as the notation suggests, ξλ(0) and ξλ(1) do not depend on the choice of z.)
setting

it follows that

on the other hand, there are holomorphic functions
a(λ), b(λ) such that

φλ + a(λ) χλ is proportional to φλ;
φλ + b(λ) χλ is proportional to χλ.since w(φλ,χλ) = 1, the green's function is given by

direct calculation shows that

where the so-called  characteristic matrix  mij(z) is given by

hence

which immediately implies

(this is a special case of the "stieltjes inversion formula".)
setting ψλ(0)=φλ and ψλ(1)=χλ, it follows that

this identity is equivalent to the spectral theorem and titchmarsh–kodaira formula.


== application to the hypergeometric equation ==

the mehler–fock transform concerns the eigenfunction expansion associated with the legendre differential operator d

on (1,∞). the eigenfunctions are the legendre functions
with eigenvalue λ ≥ 0. the two mehler–fock transformations are
and

(often this is written in terms of the variable τ = √λ.)
mehler and fock studied this differential operator because it arose as the radial component of the laplacian on 2-dimensional hyperbolic space. 
more generally, consider the group g = su(1,1) consisting of complex matrices of the form

with determinant |α|2 − |β|2 = 1.


== application to the hydrogen atom ==


== generalisations and alternative approaches ==
a weyl function can be defined at a singular endpoint 
  
    
      
        a
      
    
    {\displaystyle a}
   giving rise to a singular version of weyl–titchmarsh–kodaira theory. this applies for example to the case of radial schrödinger operators

the whole theory can also be extended to the case where the coefficients are allowed to be measures.


== gelfand–levitan theory ==


== notes ==


== references ==
akhiezer, naum ilich; glazman, izrael markovich (1993), theory of linear operators in hilbert space, dover, isbn 978-0-486-67748-4
bellman, richard (1969), stability theory of differential equations, dover, isbn 978-0-486-62210-1
coddington, earl a.; levinson, norman (1955), theory of ordinary differential equations, mcgraw-hill, isbn 978-0-07-011542-2
courant, richard; hilbert, david (1989), method of mathematical physics, vol. i, wiley-interscience, isbn 978-0-471-50447-4
dieudonné, jean (1969), treatise on analysis, vol. i [foundations of modern analysis], academic press, isbn 978-1-4067-2791-3
dieudonné, jean (1988), treatise on analysis, vol. viii, academic press, isbn 978-0-12-215507-9
dunford, nelson; schwartz, jacob t. (1963), linear operators, part ii spectral theory. self adjoint operators in hilbert space, wiley interscience, isbn 978-0-471-60847-9
hille, einar (1969), lectures on ordinary differential equations, addison-wesley, isbn 978-0-201-53083-4
kodaira, kunihiko (1949), "the eigenvalue problem for ordinary differential equations of the second order and heisenberg's theory of s-matrices", american journal of mathematics, 71 (4): 921–945, doi:10.2307/2372377, jstor 2372377
kodaira, kunihiko (1950), "on ordinary differential equations of any even order and the corresponding eigenfunction expansions", american journal of mathematics, 72 (3): 502–544, doi:10.2307/2372051, jstor 2372051
mehler, f.g. (1881), "ueber mit der kugel- und cylinderfunctionen verwandte function und ihre anwendung in der theorie der elektricitätsverteilung", mathematische annalen, 18 (2): 161–194, doi:10.1007/bf01445847
reed, michael; simon, barry (1975), methods of modern mathematical physics ii, fourier analysis, self-adjointness, academic press, isbn 978-0-12-585002-5
riesz, frigyes; szőkefalvi-nagy, béla (1990). functional analysis. dover publications. isbn 0-486-66289-6.
stone, marshall harvey (1932), linear transformations in hilbert space and their applications to analysis, ams colloquium publications, vol. 16, isbn 978-0-8218-1015-6
teschl, gerald (2009). mathematical methods in quantum mechanics; with applications to schrödinger operators. ams graduate studies in mathematics. vol. 99. isbn 978-0-8218-4660-5.
teschl, gerald (2012). ordinary differential equations and dynamical systems. ams graduate studies in mathematics. vol. 140. isbn 978-0-8218-8328-0.
titchmarsh, edward charles (1946), eigenfunction expansions associated with second order differential equations, vol. i (1st ed.), oxford university press
titchmarsh, edward charles (1962), eigenfunction expansions associated with second order differential equations, vol. i (2nd ed.), oxford university press, isbn 978-0-608-08254-7
vilenkin, naoum iakovlevitch (1968), special functions and the theory of group representations, translations of mathematical monographs, vol. 22, american mathematical society, isbn 978-0-8218-1572-4
weidmann, joachim (1987), spectral theory of ordinary differential operators, lecture notes in mathematics, vol. 1258, springer-verlag, isbn 978-0-387-17902-5
weyl, hermann (1910a), "über gewöhnliche differentialgleichungen mit singularitäten und die zugehörigen entwicklungen willkürlicher functionen", mathematische annalen, 68 (2): 220–269, doi:10.1007/bf01474161
weyl, hermann (1910b), "über gewöhnliche differentialgleichungen mit singulären stellen und ihre eigenfunktionen", nachr. akad. wiss. göttingen. math.-phys.: 442–446
weyl, hermann (1935), "über das pick-nevanlinnasche interpolationsproblem und sein infinitesimales analogen", annals of mathematics, 36 (1): 230–254, doi:10.2307/1968677, jstor 1968677