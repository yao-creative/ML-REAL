a doob martingale (named after joseph l. doob, also known as a levy martingale) in mathematics probability theory, is a construction of a stochastic process which approximates a given random variable and has the martingale property with respect to the given filtration. it may be thought of as the evolving sequence of best approximations to the random variable based on information accumulated up to a certain time.
when analyzing sums, random walks, or other additive functions of independent random variables, one can often apply the central limit theorem, law of large numbers, chernoff's inequality, chebyshev's inequality or similar tools. when analyzing similar objects where the differences are not independent, the main tools are martingales and azuma's inequality.


== definition ==
let 
  
    
      
        y
      
    
    {\displaystyle y}
   be any random variable with 
  
    
      
        
          e
        
        [
        
          |
        
        y
        
          |
        
        ]
        <
        ∞
      
    
    {\displaystyle \mathbb {e} [|y|]<\infty }
  . suppose 
  
    
      
        
          {
          
            
              
                
                  f
                
              
              
                0
              
            
            ,
            
              
                
                  f
                
              
              
                1
              
            
            ,
            …
          
          }
        
      
    
    {\displaystyle \left\{{\mathcal {f}}_{0},{\mathcal {f}}_{1},\dots \right\}}
   is a filtration, i.e. 
  
    
      
        
          
            
              f
            
          
          
            s
          
        
        ⊂
        
          
            
              f
            
          
          
            t
          
        
      
    
    {\displaystyle {\mathcal {f}}_{s}\subset {\mathcal {f}}_{t}}
   when 
  
    
      
        s
        <
        t
      
    
    {\displaystyle s<t}
  . define

  
    
      
        
          z
          
            t
          
        
        =
        
          e
        
        [
        y
        ∣
        
          
            
              f
            
          
          
            t
          
        
        ]
        ,
      
    
    {\displaystyle z_{t}=\mathbb {e} [y\mid {\mathcal {f}}_{t}],}
  then 
  
    
      
        
          {
          
            
              z
              
                0
              
            
            ,
            
              z
              
                1
              
            
            ,
            …
          
          }
        
      
    
    {\displaystyle \left\{z_{0},z_{1},\dots \right\}}
   is a martingale, namely doob martingale, with respect to filtration 
  
    
      
        
          {
          
            
              
                
                  f
                
              
              
                0
              
            
            ,
            
              
                
                  f
                
              
              
                1
              
            
            ,
            …
          
          }
        
      
    
    {\displaystyle \left\{{\mathcal {f}}_{0},{\mathcal {f}}_{1},\dots \right\}}
  . 
to see this, note that

  
    
      
        
          e
        
        [
        
          |
        
        
          z
          
            t
          
        
        
          |
        
        ]
        =
        
          e
        
        [
        
          |
        
        
          e
        
        [
        y
        ∣
        
          
            
              f
            
          
          
            t
          
        
        ]
        
          |
        
        ]
        ≤
        
          e
        
        [
        
          e
        
        [
        
          |
        
        y
        
          |
        
        ∣
        
          
            
              f
            
          
          
            t
          
        
        ]
        ]
        =
        
          e
        
        [
        
          |
        
        y
        
          |
        
        ]
        <
        ∞
      
    
    {\displaystyle \mathbb {e} [|z_{t}|]=\mathbb {e} [|\mathbb {e} [y\mid {\mathcal {f}}_{t}]|]\leq \mathbb {e} [\mathbb {e} [|y|\mid {\mathcal {f}}_{t}]]=\mathbb {e} [|y|]<\infty }
  ;

  
    
      
        
          e
        
        [
        
          z
          
            t
          
        
        ∣
        
          
            
              f
            
          
          
            t
            −
            1
          
        
        ]
        =
        
          e
        
        [
        
          e
        
        [
        y
        ∣
        
          
            
              f
            
          
          
            t
          
        
        ]
        ∣
        
          
            
              f
            
          
          
            t
            −
            1
          
        
        ]
        =
        
          e
        
        [
        y
        ∣
        
          
            
              f
            
          
          
            t
            −
            1
          
        
        ]
        =
        
          z
          
            t
            −
            1
          
        
      
    
    {\displaystyle \mathbb {e} [z_{t}\mid {\mathcal {f}}_{t-1}]=\mathbb {e} [\mathbb {e} [y\mid {\mathcal {f}}_{t}]\mid {\mathcal {f}}_{t-1}]=\mathbb {e} [y\mid {\mathcal {f}}_{t-1}]=z_{t-1}}
   as 
  
    
      
        
          
            
              f
            
          
          
            t
            −
            1
          
        
        ⊂
        
          
            
              f
            
          
          
            t
          
        
      
    
    {\displaystyle {\mathcal {f}}_{t-1}\subset {\mathcal {f}}_{t}}
  .in particular, for any sequence of random variables 
  
    
      
        
          {
          
            
              x
              
                1
              
            
            ,
            
              x
              
                2
              
            
            ,
            …
            ,
            
              x
              
                n
              
            
          
          }
        
      
    
    {\displaystyle \left\{x_{1},x_{2},\dots ,x_{n}\right\}}
   on probability space  
  
    
      
        (
        ω
        ,
        
          
            f
          
        
        ,
        
          p
        
        )
      
    
    {\displaystyle (\omega ,{\mathcal {f}},{\text{p}})}
   and function 
  
    
      
        f
      
    
    {\displaystyle f}
   such that 
  
    
      
        
          e
        
        [
        
          |
        
        f
        (
        
          x
          
            1
          
        
        ,
        
          x
          
            2
          
        
        ,
        …
        ,
        
          x
          
            n
          
        
        )
        
          |
        
        ]
        <
        ∞
      
    
    {\displaystyle \mathbb {e} [|f(x_{1},x_{2},\dots ,x_{n})|]<\infty }
  , one could choose 

  
    
      
        y
        :=
        f
        (
        
          x
          
            1
          
        
        ,
        
          x
          
            2
          
        
        ,
        …
        ,
        
          x
          
            n
          
        
        )
      
    
    {\displaystyle y:=f(x_{1},x_{2},\dots ,x_{n})}
  and filtration 
  
    
      
        
          {
          
            
              
                
                  f
                
              
              
                0
              
            
            ,
            
              
                
                  f
                
              
              
                1
              
            
            ,
            …
          
          }
        
      
    
    {\displaystyle \left\{{\mathcal {f}}_{0},{\mathcal {f}}_{1},\dots \right\}}
   such that

  
    
      
        
          
            
              
                
                  
                    
                      f
                    
                  
                  
                    0
                  
                
              
              
                
                :=
                
                  {
                  
                    ϕ
                    ,
                    ω
                  
                  }
                
                ,
              
            
            
              
                
                  
                    
                      f
                    
                  
                  
                    t
                  
                
              
              
                
                :=
                σ
                (
                
                  x
                  
                    1
                  
                
                ,
                
                  x
                  
                    2
                  
                
                ,
                …
                ,
                
                  x
                  
                    t
                  
                
                )
                ,
                ∀
                t
                ≥
                1
                ,
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}{\mathcal {f}}_{0}&:=\left\{\phi ,\omega \right\},\\{\mathcal {f}}_{t}&:=\sigma (x_{1},x_{2},\dots ,x_{t}),\forall t\geq 1,\end{aligned}}}
  i.e. 
  
    
      
        σ
      
    
    {\displaystyle \sigma }
  -algebra generated by 
  
    
      
        
          x
          
            1
          
        
        ,
        
          x
          
            2
          
        
        ,
        …
        ,
        
          x
          
            t
          
        
      
    
    {\displaystyle x_{1},x_{2},\dots ,x_{t}}
  . then, by definition of doob martingale, process 
  
    
      
        
          {
          
            
              z
              
                0
              
            
            ,
            
              z
              
                1
              
            
            ,
            …
          
          }
        
      
    
    {\displaystyle \left\{z_{0},z_{1},\dots \right\}}
   where

  
    
      
        
          
            
              
                
                  z
                  
                    0
                  
                
              
              
                
                :=
                
                  e
                
                [
                f
                (
                
                  x
                  
                    1
                  
                
                ,
                
                  x
                  
                    2
                  
                
                ,
                …
                ,
                
                  x
                  
                    n
                  
                
                )
                ∣
                
                  
                    
                      f
                    
                  
                  
                    0
                  
                
                ]
                =
                
                  e
                
                [
                f
                (
                
                  x
                  
                    1
                  
                
                ,
                
                  x
                  
                    2
                  
                
                ,
                …
                ,
                
                  x
                  
                    n
                  
                
                )
                ]
                ,
              
            
            
              
                
                  z
                  
                    t
                  
                
              
              
                
                :=
                
                  e
                
                [
                f
                (
                
                  x
                  
                    1
                  
                
                ,
                
                  x
                  
                    2
                  
                
                ,
                …
                ,
                
                  x
                  
                    n
                  
                
                )
                ∣
                
                  
                    
                      f
                    
                  
                  
                    t
                  
                
                ]
                =
                
                  e
                
                [
                f
                (
                
                  x
                  
                    1
                  
                
                ,
                
                  x
                  
                    2
                  
                
                ,
                …
                ,
                
                  x
                  
                    n
                  
                
                )
                ∣
                
                  x
                  
                    1
                  
                
                ,
                
                  x
                  
                    2
                  
                
                ,
                …
                ,
                
                  x
                  
                    t
                  
                
                ]
                ,
                ∀
                t
                ≥
                1
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}z_{0}&:=\mathbb {e} [f(x_{1},x_{2},\dots ,x_{n})\mid {\mathcal {f}}_{0}]=\mathbb {e} [f(x_{1},x_{2},\dots ,x_{n})],\\z_{t}&:=\mathbb {e} [f(x_{1},x_{2},\dots ,x_{n})\mid {\mathcal {f}}_{t}]=\mathbb {e} [f(x_{1},x_{2},\dots ,x_{n})\mid x_{1},x_{2},\dots ,x_{t}],\forall t\geq 1\end{aligned}}}
  forms a doob martingale. note that 
  
    
      
        
          z
          
            n
          
        
        =
        f
        (
        
          x
          
            1
          
        
        ,
        
          x
          
            2
          
        
        ,
        …
        ,
        
          x
          
            n
          
        
        )
      
    
    {\displaystyle z_{n}=f(x_{1},x_{2},\dots ,x_{n})}
  . this martingale can be used to prove mcdiarmid's inequality.


== mcdiarmid's inequality ==


=== statement ===
consider independent random variables 
  
    
      
        
          x
          
            1
          
        
        ,
        
          x
          
            2
          
        
        ,
        …
        
          x
          
            n
          
        
      
    
    {\displaystyle x_{1},x_{2},\dots x_{n}}
   on probability space 
  
    
      
        (
        ω
        ,
        
          
            f
          
        
        ,
        
          p
        
        )
      
    
    {\displaystyle (\omega ,{\mathcal {f}},{\text{p}})}
   where 
  
    
      
        
          x
          
            i
          
        
        ∈
        
          
            
              x
            
          
          
            i
          
        
      
    
    {\displaystyle x_{i}\in {\mathcal {x}}_{i}}
   for all 
  
    
      
        i
      
    
    {\displaystyle i}
   and a mapping 
  
    
      
        f
        :
        
          
            
              x
            
          
          
            1
          
        
        ×
        
          
            
              x
            
          
          
            2
          
        
        ×
        ⋯
        ×
        
          
            
              x
            
          
          
            n
          
        
        →
        
          r
        
      
    
    {\displaystyle f:{\mathcal {x}}_{1}\times {\mathcal {x}}_{2}\times \cdots \times {\mathcal {x}}_{n}\rightarrow \mathbb {r} }
  . assume there exist constant 
  
    
      
        
          c
          
            1
          
        
        ,
        
          c
          
            2
          
        
        ,
        …
        ,
        
          c
          
            n
          
        
      
    
    {\displaystyle c_{1},c_{2},\dots ,c_{n}}
   such that for all 
  
    
      
        i
      
    
    {\displaystyle i}
  ,

  
    
      
        
          
            sup
            
              
                x
                
                  1
                
              
              ,
              ⋯
              ,
              
                x
                
                  i
                  −
                  1
                
              
              ,
              
                x
                
                  i
                
              
              ,
              
                x
                
                  i
                
                ′
              
              ,
              
                x
                
                  i
                  +
                  1
                
              
              ,
              ⋯
              ,
              
                x
                
                  n
                
              
            
          
        
        
          |
        
        f
        (
        
          x
          
            1
          
        
        ,
        …
        ,
        
          x
          
            i
            −
            1
          
        
        ,
        
          x
          
            i
          
        
        ,
        
          x
          
            i
            +
            1
          
        
        ,
        ⋯
        ,
        
          x
          
            n
          
        
        )
        −
        f
        (
        
          x
          
            1
          
        
        ,
        …
        ,
        
          x
          
            i
            −
            1
          
        
        ,
        
          x
          
            i
          
          ′
        
        ,
        
          x
          
            i
            +
            1
          
        
        ,
        ⋯
        ,
        
          x
          
            n
          
        
        )
        
          |
        
        ≤
        
          c
          
            i
          
        
        .
      
    
    {\displaystyle {\underset {x_{1},\cdots ,x_{i-1},x_{i},x_{i}',x_{i+1},\cdots ,x_{n}}{\sup }}|f(x_{1},\dots ,x_{i-1},x_{i},x_{i+1},\cdots ,x_{n})-f(x_{1},\dots ,x_{i-1},x_{i}',x_{i+1},\cdots ,x_{n})|\leq c_{i}.}
  (in other words, changing the value of the 
  
    
      
        i
      
    
    {\displaystyle i}
  th coordinate 
  
    
      
        
          x
          
            i
          
        
      
    
    {\displaystyle x_{i}}
   changes the value of 
  
    
      
        f
      
    
    {\displaystyle f}
   by at most 
  
    
      
        
          c
          
            i
          
        
      
    
    {\displaystyle c_{i}}
  .) then, for any 
  
    
      
        ϵ
        >
        0
      
    
    {\displaystyle \epsilon >0}
  ,

  
    
      
        
          p
        
        (
        f
        (
        
          x
          
            1
          
        
        ,
        
          x
          
            2
          
        
        ,
        ⋯
        ,
        
          x
          
            n
          
        
        )
        −
        
          e
        
        [
        f
        (
        
          x
          
            1
          
        
        ,
        
          x
          
            2
          
        
        ,
        ⋯
        ,
        
          x
          
            n
          
        
        )
        ]
        ≥
        ϵ
        )
        ≤
        exp
        ⁡
        
          (
          
            −
            
              
                
                  2
                  
                    ϵ
                    
                      2
                    
                  
                
                
                  
                    ∑
                    
                      i
                      =
                      1
                    
                    
                      n
                    
                  
                  
                    c
                    
                      i
                    
                    
                      2
                    
                  
                
              
            
          
          )
        
        ,
      
    
    {\displaystyle {\text{p}}(f(x_{1},x_{2},\cdots ,x_{n})-\mathbb {e} [f(x_{1},x_{2},\cdots ,x_{n})]\geq \epsilon )\leq \exp \left(-{\frac {2\epsilon ^{2}}{\sum _{i=1}^{n}c_{i}^{2}}}\right),}
  

  
    
      
        
          p
        
        (
        f
        (
        
          x
          
            1
          
        
        ,
        
          x
          
            2
          
        
        ,
        ⋯
        ,
        
          x
          
            n
          
        
        )
        −
        
          e
        
        [
        f
        (
        
          x
          
            1
          
        
        ,
        
          x
          
            2
          
        
        ,
        ⋯
        ,
        
          x
          
            n
          
        
        )
        ]
        ≤
        −
        ϵ
        )
        ≤
        exp
        ⁡
        
          (
          
            −
            
              
                
                  2
                  
                    ϵ
                    
                      2
                    
                  
                
                
                  
                    ∑
                    
                      i
                      =
                      1
                    
                    
                      n
                    
                  
                  
                    c
                    
                      i
                    
                    
                      2
                    
                  
                
              
            
          
          )
        
        ,
      
    
    {\displaystyle {\text{p}}(f(x_{1},x_{2},\cdots ,x_{n})-\mathbb {e} [f(x_{1},x_{2},\cdots ,x_{n})]\leq -\epsilon )\leq \exp \left(-{\frac {2\epsilon ^{2}}{\sum _{i=1}^{n}c_{i}^{2}}}\right),}
  and

  
    
      
        
          p
        
        (
        
          |
        
        f
        (
        
          x
          
            1
          
        
        ,
        
          x
          
            2
          
        
        ,
        ⋯
        ,
        
          x
          
            n
          
        
        )
        −
        
          e
        
        [
        f
        (
        
          x
          
            1
          
        
        ,
        
          x
          
            2
          
        
        ,
        ⋯
        ,
        
          x
          
            n
          
        
        )
        ]
        
          |
        
        ≥
        ϵ
        )
        ≤
        2
        exp
        ⁡
        
          (
          
            −
            
              
                
                  2
                  
                    ϵ
                    
                      2
                    
                  
                
                
                  
                    ∑
                    
                      i
                      =
                      1
                    
                    
                      n
                    
                  
                  
                    c
                    
                      i
                    
                    
                      2
                    
                  
                
              
            
          
          )
        
        .
      
    
    {\displaystyle {\text{p}}(|f(x_{1},x_{2},\cdots ,x_{n})-\mathbb {e} [f(x_{1},x_{2},\cdots ,x_{n})]|\geq \epsilon )\leq 2\exp \left(-{\frac {2\epsilon ^{2}}{\sum _{i=1}^{n}c_{i}^{2}}}\right).}
  


=== proof ===
pick any 
  
    
      
        
          x
          
            1
          
          ′
        
        ,
        
          x
          
            2
          
          ′
        
        ,
        ⋯
        ,
        
          x
          
            n
          
          ′
        
      
    
    {\displaystyle x_{1}',x_{2}',\cdots ,x_{n}'}
   such that the value of 
  
    
      
        f
        (
        
          x
          
            1
          
          ′
        
        ,
        
          x
          
            2
          
          ′
        
        ,
        ⋯
        ,
        
          x
          
            n
          
          ′
        
        )
      
    
    {\displaystyle f(x_{1}',x_{2}',\cdots ,x_{n}')}
   is bounded, then, for any 
  
    
      
        
          x
          
            1
          
        
        ,
        
          x
          
            2
          
        
        ,
        ⋯
        ,
        
          x
          
            n
          
        
      
    
    {\displaystyle x_{1},x_{2},\cdots ,x_{n}}
  , by triangle inequality,

  
    
      
        
          
            
              
              
                
                
                  |
                
                f
                (
                
                  x
                  
                    1
                  
                
                ,
                
                  x
                  
                    2
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    n
                  
                
                )
                −
                f
                (
                
                  x
                  
                    1
                  
                  ′
                
                ,
                
                  x
                  
                    2
                  
                  ′
                
                ,
                ⋯
                ,
                
                  x
                  
                    n
                  
                  ′
                
                )
                
                  |
                
              
            
            
              
                ≤
              
              
                
                
                  |
                
                f
                (
                
                  x
                  
                    1
                  
                
                ,
                
                  x
                  
                    2
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    n
                  
                
                )
                −
                f
                (
                
                  x
                  
                    1
                  
                  ′
                
                ,
                
                  x
                  
                    2
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    n
                  
                
                )
                
                  |
                
              
            
            
              
              
                
                +
                
                  ∑
                  
                    i
                    =
                    1
                  
                  
                    n
                    −
                    1
                  
                
                
                  |
                
                f
                (
                
                  x
                  
                    1
                  
                  ′
                
                ,
                ⋯
                ,
                
                  x
                  
                    i
                  
                  ′
                
                ,
                
                  x
                  
                    i
                    +
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    n
                  
                
                )
                −
                f
                (
                
                  x
                  
                    1
                  
                  ′
                
                ,
                
                  x
                  
                    2
                  
                  ′
                
                ,
                ⋯
                ,
                
                  x
                  
                    i
                  
                  ′
                
                ,
                
                  x
                  
                    i
                    +
                    1
                  
                  ′
                
                ,
                
                  x
                  
                    i
                    +
                    2
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    n
                  
                
                )
                
                  |
                
              
            
            
              
                ≤
              
              
                
                
                  ∑
                  
                    i
                    =
                    1
                  
                  
                    n
                  
                
                
                  c
                  
                    i
                  
                
                ,
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}&|f(x_{1},x_{2},\cdots ,x_{n})-f(x_{1}',x_{2}',\cdots ,x_{n}')|\\\leq &|f(x_{1},x_{2},\cdots ,x_{n})-f(x_{1}',x_{2},\cdots ,x_{n})|\\&+\sum _{i=1}^{n-1}|f(x_{1}',\cdots ,x_{i}',x_{i+1},\cdots ,x_{n})-f(x_{1}',x_{2}',\cdots ,x_{i}',x_{i+1}',x_{i+2},\cdots ,x_{n})|\\\leq &\sum _{i=1}^{n}c_{i},\end{aligned}}}
  thus 
  
    
      
        f
      
    
    {\displaystyle f}
   is bounded.
define 
  
    
      
        
          z
          
            i
          
        
        :=
        
          e
        
        [
        f
        (
        
          x
          
            1
          
        
        ,
        
          x
          
            2
          
        
        ,
        ⋯
        ,
        
          x
          
            n
          
        
        )
        ∣
        
          x
          
            1
          
        
        ,
        
          x
          
            2
          
        
        ,
        ⋯
        ,
        
          x
          
            i
          
        
        ]
      
    
    {\displaystyle z_{i}:=\mathbb {e} [f(x_{1},x_{2},\cdots ,x_{n})\mid x_{1},x_{2},\cdots ,x_{i}]}
   for all 
  
    
      
        i
        ≥
        1
      
    
    {\displaystyle i\geq 1}
   and 
  
    
      
        
          z
          
            0
          
        
        :=
        
          e
        
        [
        f
        (
        
          x
          
            1
          
        
        ,
        
          x
          
            2
          
        
        ,
        ⋯
        ,
        
          x
          
            n
          
        
        )
        ]
      
    
    {\displaystyle z_{0}:=\mathbb {e} [f(x_{1},x_{2},\cdots ,x_{n})]}
  . note that 
  
    
      
        
          z
          
            n
          
        
        =
        f
        (
        
          x
          
            1
          
        
        ,
        
          x
          
            2
          
        
        ,
        ⋯
        ,
        
          x
          
            n
          
        
        )
      
    
    {\displaystyle z_{n}=f(x_{1},x_{2},\cdots ,x_{n})}
  . since 
  
    
      
        f
      
    
    {\displaystyle f}
   is bounded, by the definition of doob martingale, 
  
    
      
        
          {
          
            z
            
              i
            
          
          }
        
      
    
    {\displaystyle \left\{z_{i}\right\}}
   forms a martingale. now define

  
    
      
        
          
            
              
                
                  u
                  
                    i
                  
                
              
              
                
                =
                
                  
                    sup
                    
                      x
                      ∈
                      
                        
                          
                            x
                          
                        
                        
                          i
                        
                      
                    
                  
                
                
                  e
                
                [
                f
                (
                
                  x
                  
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    n
                  
                
                )
                ∣
                
                  x
                  
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    i
                    −
                    1
                  
                
                ,
                x
                ]
                −
                
                  e
                
                [
                f
                (
                
                  x
                  
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    n
                  
                
                )
                ∣
                
                  x
                  
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    i
                    −
                    1
                  
                
                ]
                ,
              
            
            
              
                
                  l
                  
                    i
                  
                
              
              
                
                =
                
                  
                    inf
                    
                      x
                      ∈
                      
                        
                          
                            x
                          
                        
                        
                          i
                        
                      
                    
                  
                
                
                  e
                
                [
                f
                (
                
                  x
                  
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    n
                  
                
                )
                ∣
                
                  x
                  
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    i
                    −
                    1
                  
                
                ,
                x
                ]
                −
                
                  e
                
                [
                f
                (
                
                  x
                  
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    n
                  
                
                )
                ∣
                
                  x
                  
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    i
                    −
                    1
                  
                
                ]
                .
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}u_{i}&={\underset {x\in {\mathcal {x}}_{i}}{\sup }}\mathbb {e} [f(x_{1},\cdots ,x_{n})\mid x_{1},\cdots ,x_{i-1},x]-\mathbb {e} [f(x_{1},\cdots ,x_{n})\mid x_{1},\cdots ,x_{i-1}],\\l_{i}&={\underset {x\in {\mathcal {x}}_{i}}{\inf }}\mathbb {e} [f(x_{1},\cdots ,x_{n})\mid x_{1},\cdots ,x_{i-1},x]-\mathbb {e} [f(x_{1},\cdots ,x_{n})\mid x_{1},\cdots ,x_{i-1}].\end{aligned}}}
  
note that 
  
    
      
        
          l
          
            i
          
        
        ≤
        
          z
          
            i
          
        
        −
        
          z
          
            i
            −
            1
          
        
        ≤
        
          u
          
            i
          
        
      
    
    {\displaystyle l_{i}\leq z_{i}-z_{i-1}\leq u_{i}}
   and 
  
    
      
        
          u
          
            i
          
        
        ,
        
          l
          
            i
          
        
      
    
    {\displaystyle u_{i},l_{i}}
   are both 
  
    
      
        
          
            
              f
            
          
          
            i
            −
            1
          
        
      
    
    {\displaystyle {\mathcal {f}}_{i-1}}
  -measurable. in addition,

  
    
      
        
          
            
              
                
                  u
                  
                    i
                  
                
                −
                
                  l
                  
                    i
                  
                
              
              
                
                =
                
                  
                    sup
                    
                      
                        x
                        
                          u
                        
                      
                      ∈
                      
                        
                          
                            x
                          
                        
                        
                          i
                        
                      
                      ,
                      
                        x
                        
                          l
                        
                      
                      ∈
                      
                        
                          
                            x
                          
                        
                        
                          i
                        
                      
                    
                  
                
                
                  e
                
                [
                f
                (
                
                  x
                  
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    n
                  
                
                )
                ∣
                
                  x
                  
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    i
                    −
                    1
                  
                
                ,
                
                  x
                  
                    u
                  
                
                ]
                −
                
                  e
                
                [
                f
                (
                
                  x
                  
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    n
                  
                
                )
                ∣
                
                  x
                  
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    i
                    −
                    1
                  
                
                ,
                
                  x
                  
                    l
                  
                
                ]
              
            
            
              
              
                
                =
                
                  
                    sup
                    
                      
                        x
                        
                          u
                        
                      
                      ∈
                      
                        
                          
                            x
                          
                        
                        
                          i
                        
                      
                      ,
                      
                        x
                        
                          l
                        
                      
                      ∈
                      
                        
                          
                            x
                          
                        
                        
                          i
                        
                      
                    
                  
                
                
                  ∫
                  
                    
                      
                        
                          x
                        
                      
                      
                        i
                        +
                        1
                      
                    
                    ×
                    ⋯
                    ×
                    
                      
                        
                          x
                        
                      
                      
                        n
                      
                    
                  
                
                f
                (
                
                  x
                  
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    i
                    −
                    1
                  
                
                ,
                
                  x
                  
                    u
                  
                
                ,
                
                  x
                  
                    i
                    +
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    n
                  
                
                )
                
                  d
                
                
                  
                    p
                  
                  
                    
                      x
                      
                        i
                        +
                        1
                      
                    
                    ,
                    ⋯
                    ,
                    
                      x
                      
                        n
                      
                    
                    ∣
                    
                      x
                      
                        1
                      
                    
                    ,
                    ⋯
                    ,
                    
                      x
                      
                        t
                        −
                        1
                      
                    
                    ,
                    
                      x
                      
                        u
                      
                    
                  
                
                (
                
                  x
                  
                    i
                    +
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    n
                  
                
                )
              
            
            
              
              
                
                
                −
                
                  ∫
                  
                    
                      
                        
                          x
                        
                      
                      
                        i
                        +
                        1
                      
                    
                    ×
                    ⋯
                    ×
                    
                      
                        
                          x
                        
                      
                      
                        n
                      
                    
                  
                
                f
                (
                
                  x
                  
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    i
                    −
                    1
                  
                
                ,
                
                  x
                  
                    l
                  
                
                ,
                
                  x
                  
                    i
                    +
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    n
                  
                
                )
                
                  d
                
                
                  
                    p
                  
                  
                    
                      x
                      
                        i
                        +
                        1
                      
                    
                    ,
                    ⋯
                    ,
                    
                      x
                      
                        n
                      
                    
                    ∣
                    
                      x
                      
                        1
                      
                    
                    ,
                    ⋯
                    ,
                    
                      x
                      
                        t
                        −
                        1
                      
                    
                    ,
                    
                      x
                      
                        l
                      
                    
                  
                
                (
                
                  x
                  
                    i
                    +
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    n
                  
                
                )
              
            
            
              
              
                
                =
                
                  
                    sup
                    
                      
                        x
                        
                          u
                        
                      
                      ∈
                      
                        
                          
                            x
                          
                        
                        
                          i
                        
                      
                      ,
                      
                        x
                        
                          l
                        
                      
                      ∈
                      
                        
                          
                            x
                          
                        
                        
                          i
                        
                      
                    
                  
                
                
                  ∫
                  
                    
                      
                        
                          x
                        
                      
                      
                        i
                        +
                        1
                      
                    
                    ×
                    ⋯
                    ×
                    
                      
                        
                          x
                        
                      
                      
                        n
                      
                    
                  
                
                f
                (
                
                  x
                  
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    i
                    −
                    1
                  
                
                ,
                
                  x
                  
                    u
                  
                
                ,
                
                  x
                  
                    i
                    +
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    n
                  
                
                )
                
                  d
                
                
                  
                    p
                  
                  
                    
                      x
                      
                        i
                        +
                        1
                      
                    
                    ,
                    ⋯
                    ,
                    
                      x
                      
                        n
                      
                    
                  
                
                (
                
                  x
                  
                    i
                    +
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    n
                  
                
                )
              
            
            
              
              
                
                
                −
                
                  ∫
                  
                    
                      
                        
                          x
                        
                      
                      
                        i
                        +
                        1
                      
                    
                    ×
                    ⋯
                    ×
                    
                      
                        
                          x
                        
                      
                      
                        n
                      
                    
                  
                
                f
                (
                
                  x
                  
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    i
                    −
                    1
                  
                
                ,
                
                  x
                  
                    l
                  
                
                ,
                
                  x
                  
                    i
                    +
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    n
                  
                
                )
                
                  d
                
                
                  
                    p
                  
                  
                    
                      x
                      
                        i
                        +
                        1
                      
                    
                    ,
                    ⋯
                    ,
                    
                      x
                      
                        n
                      
                    
                  
                
                (
                
                  x
                  
                    i
                    +
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    n
                  
                
                )
              
            
            
              
              
                
                =
                
                  
                    sup
                    
                      
                        x
                        
                          u
                        
                      
                      ∈
                      
                        
                          
                            x
                          
                        
                        
                          i
                        
                      
                      ,
                      
                        x
                        
                          l
                        
                      
                      ∈
                      
                        
                          
                            x
                          
                        
                        
                          i
                        
                      
                    
                  
                
                
                  ∫
                  
                    
                      
                        
                          x
                        
                      
                      
                        i
                        +
                        1
                      
                    
                    ×
                    ⋯
                    ×
                    
                      
                        
                          x
                        
                      
                      
                        n
                      
                    
                  
                
                f
                (
                
                  x
                  
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    i
                    −
                    1
                  
                
                ,
                
                  x
                  
                    u
                  
                
                ,
                
                  x
                  
                    i
                    +
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    n
                  
                
                )
              
            
            
              
              
                
                
                −
                f
                (
                
                  x
                  
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    i
                    −
                    1
                  
                
                ,
                
                  x
                  
                    l
                  
                
                ,
                
                  x
                  
                    i
                    +
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    n
                  
                
                )
                 
                
                  d
                
                
                  
                    p
                  
                  
                    
                      x
                      
                        i
                        +
                        1
                      
                    
                    ,
                    ⋯
                    ,
                    
                      x
                      
                        n
                      
                    
                  
                
                (
                
                  x
                  
                    i
                    +
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    n
                  
                
                )
              
            
            
              
              
                
                ≤
                
                  
                    sup
                    
                      
                        x
                        
                          u
                        
                      
                      ∈
                      
                        
                          
                            x
                          
                        
                        
                          i
                        
                      
                      ,
                      
                        x
                        
                          l
                        
                      
                      ∈
                      
                        
                          
                            x
                          
                        
                        
                          i
                        
                      
                    
                  
                
                
                  ∫
                  
                    
                      
                        
                          x
                        
                      
                      
                        i
                        +
                        1
                      
                    
                    ×
                    ⋯
                    ×
                    
                      
                        
                          x
                        
                      
                      
                        n
                      
                    
                  
                
                
                  c
                  
                    i
                  
                
                 
                
                  d
                
                
                  
                    p
                  
                  
                    
                      x
                      
                        i
                        +
                        1
                      
                    
                    ,
                    ⋯
                    ,
                    
                      x
                      
                        n
                      
                    
                  
                
                (
                
                  x
                  
                    i
                    +
                    1
                  
                
                ,
                ⋯
                ,
                
                  x
                  
                    n
                  
                
                )
              
            
            
              
              
                
                ≤
                
                  c
                  
                    i
                  
                
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}u_{i}-l_{i}&={\underset {x_{u}\in {\mathcal {x}}_{i},x_{l}\in {\mathcal {x}}_{i}}{\sup }}\mathbb {e} [f(x_{1},\cdots ,x_{n})\mid x_{1},\cdots ,x_{i-1},x_{u}]-\mathbb {e} [f(x_{1},\cdots ,x_{n})\mid x_{1},\cdots ,x_{i-1},x_{l}]\\&={\underset {x_{u}\in {\mathcal {x}}_{i},x_{l}\in {\mathcal {x}}_{i}}{\sup }}\int _{{\mathcal {x}}_{i+1}\times \cdots \times {\mathcal {x}}_{n}}f(x_{1},\cdots ,x_{i-1},x_{u},x_{i+1},\cdots ,x_{n}){\text{d}}{\text{p}}_{x_{i+1},\cdots ,x_{n}\mid x_{1},\cdots ,x_{t-1},x_{u}}(x_{i+1},\cdots ,x_{n})\\&\quad -\int _{{\mathcal {x}}_{i+1}\times \cdots \times {\mathcal {x}}_{n}}f(x_{1},\cdots ,x_{i-1},x_{l},x_{i+1},\cdots ,x_{n}){\text{d}}{\text{p}}_{x_{i+1},\cdots ,x_{n}\mid x_{1},\cdots ,x_{t-1},x_{l}}(x_{i+1},\cdots ,x_{n})\\&={\underset {x_{u}\in {\mathcal {x}}_{i},x_{l}\in {\mathcal {x}}_{i}}{\sup }}\int _{{\mathcal {x}}_{i+1}\times \cdots \times {\mathcal {x}}_{n}}f(x_{1},\cdots ,x_{i-1},x_{u},x_{i+1},\cdots ,x_{n}){\text{d}}{\text{p}}_{x_{i+1},\cdots ,x_{n}}(x_{i+1},\cdots ,x_{n})\\&\quad -\int _{{\mathcal {x}}_{i+1}\times \cdots \times {\mathcal {x}}_{n}}f(x_{1},\cdots ,x_{i-1},x_{l},x_{i+1},\cdots ,x_{n}){\text{d}}{\text{p}}_{x_{i+1},\cdots ,x_{n}}(x_{i+1},\cdots ,x_{n})\\&={\underset {x_{u}\in {\mathcal {x}}_{i},x_{l}\in {\mathcal {x}}_{i}}{\sup }}\int _{{\mathcal {x}}_{i+1}\times \cdots \times {\mathcal {x}}_{n}}f(x_{1},\cdots ,x_{i-1},x_{u},x_{i+1},\cdots ,x_{n})\\&\quad -f(x_{1},\cdots ,x_{i-1},x_{l},x_{i+1},\cdots ,x_{n})\ {\text{d}}{\text{p}}_{x_{i+1},\cdots ,x_{n}}(x_{i+1},\cdots ,x_{n})\\&\leq {\underset {x_{u}\in {\mathcal {x}}_{i},x_{l}\in {\mathcal {x}}_{i}}{\sup }}\int _{{\mathcal {x}}_{i+1}\times \cdots \times {\mathcal {x}}_{n}}c_{i}\ {\text{d}}{\text{p}}_{x_{i+1},\cdots ,x_{n}}(x_{i+1},\cdots ,x_{n})\\&\leq c_{i}\end{aligned}}}
  where the third equality holds due to the independence of 
  
    
      
        
          x
          
            1
          
        
        ,
        
          x
          
            2
          
        
        ,
        ⋯
        ,
        
          x
          
            n
          
        
      
    
    {\displaystyle x_{1},x_{2},\cdots ,x_{n}}
  . then, applying the general form of azuma's inequality to 
  
    
      
        
          {
          
            z
            
              i
            
          
          }
        
      
    
    {\displaystyle \left\{z_{i}\right\}}
  , we have

  
    
      
        
          p
        
        (
        f
        (
        
          x
          
            1
          
        
        ,
        ⋯
        ,
        
          x
          
            n
          
        
        )
        −
        
          e
        
        [
        f
        (
        
          x
          
            1
          
        
        ,
        ⋯
        ,
        
          x
          
            n
          
        
        )
        ]
        ≥
        ϵ
        )
        =
        
          p
        
        (
        
          z
          
            n
          
        
        −
        
          z
          
            0
          
        
        ≥
        ϵ
        )
        ≤
        exp
        ⁡
        
          (
          
            −
            
              
                
                  2
                  
                    ϵ
                    
                      2
                    
                  
                
                
                  
                    ∑
                    
                      i
                      =
                      1
                    
                    
                      n
                    
                  
                  
                    c
                    
                      i
                    
                    
                      2
                    
                  
                
              
            
          
          )
        
        .
      
    
    {\displaystyle {\text{p}}(f(x_{1},\cdots ,x_{n})-\mathbb {e} [f(x_{1},\cdots ,x_{n})]\geq \epsilon )={\text{p}}(z_{n}-z_{0}\geq \epsilon )\leq \exp \left(-{\frac {2\epsilon ^{2}}{\sum _{i=1}^{n}c_{i}^{2}}}\right).}
  one-sided bound from the other direction is obtained by applying azuma's inequality to 
  
    
      
        
          {
          
            −
            
              z
              
                i
              
            
          
          }
        
      
    
    {\displaystyle \left\{-z_{i}\right\}}
   and two-sided bound follows from union bound. 
  
    
      
        ◻
      
    
    {\displaystyle \square }
  


== see also ==


== references ==