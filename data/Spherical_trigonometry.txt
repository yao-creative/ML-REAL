spherical trigonometry is the branch of spherical geometry that deals with the relationships between trigonometric functions of the sides and angles of the spherical polygons (especially spherical triangles) defined by a number of intersecting great circles on the sphere. spherical trigonometry is of great importance for calculations in astronomy, geodesy, and navigation.
the origins of spherical trigonometry in greek mathematics and the major developments in islamic mathematics are discussed fully in history of trigonometry and mathematics in medieval islam. the subject came to fruition in early modern times with important developments by john napier, delambre and others, and attained an essentially complete form by the end of the nineteenth century with the publication of todhunter's textbook spherical trigonometry for the use of colleges and schools.
since then, significant developments have been the application of vector methods, and the use of numerical methods.


== preliminaries ==


=== spherical polygons ===
a spherical polygon is a polygon on the surface of the sphere defined by a number of great-circle arcs, which are the intersection of the surface with planes through the centre of the sphere. such polygons may have any number of sides. two planes define a lune, also called a "digon" or bi-angle, the two-sided analogue of the triangle: a familiar example is the curved surface of a segment of an orange.
three planes define a spherical triangle, the principal subject of this article. four planes define a spherical quadrilateral: such a figure, and higher sided polygons, can always be treated as a number of spherical triangles.
one spherical polygon with interesting properties is the pentagramma mirificum, a spherical 5-sided star polygon with all right angles.
from this point the article will be restricted to spherical triangles, denoted simply as triangles.


=== notation ===

both vertices and angles at the vertices are denoted by the same upper case letters a, b, and c.
the angles a, b, c of the triangle are equal to the angles between the planes that intersect the surface of the sphere or, equivalently, the angles between the tangent vectors of the great circle arcs where they meet at the vertices. angles are in radians. the angles of proper spherical triangles are (by convention) less than π so that π < a + b + c < 3π. (todhunter, art.22,32).
the sides are denoted by lower-case letters a, b, and c. on the unit sphere their lengths are numerically equal to the radian measure of the angles that the great circle arcs subtend at the centre. the sides of proper spherical triangles are (by convention) less than π so that 0 < a + b + c < 2π. (todhunter, art.22,32).
the radius of the sphere is taken as unity. for specific practical problems on a sphere of radius r the measured lengths of the sides must be divided by r before using the identities given below. likewise, after a calculation on the unit sphere the sides a, b, c must be multiplied by r.


=== polar triangles ===

the polar triangle associated with a triangle abc is defined as follows. consider the great circle that contains the side bc. this great circle is defined by the intersection of a diametral plane with the surface. draw the normal to that plane at the centre: it intersects the surface at two points and the point that is on the same side of the plane as a is (conventionally) termed the pole of a and it is denoted by a′. the points b′ and c′ are defined similarly.
the triangle a′b′c′ is the polar triangle corresponding to triangle abc. a very important theorem (todhunter, art.27) proves that the angles and sides of the polar triangle are
given by

  
    
      
        
          
            
              
                
                  a
                  ′
                
              
              
                
                =
                π
                −
                a
                ,
              
              
                
                
                  b
                  ′
                
              
              
                
                =
                π
                −
                b
                ,
              
              
                
                
                  c
                  ′
                
              
              
                
                =
                π
                −
                c
                ,
              
            
            
              
                
                  a
                  ′
                
              
              
                
                =
                π
                −
                a
                ,
              
              
                
                  b
                  ′
                
              
              
                
                =
                π
                −
                b
                ,
              
              
                
                  c
                  ′
                
              
              
                
                =
                π
                −
                c
                .
              
            
          
        
      
    
    {\displaystyle {\begin{alignedat}{3}a'&=\pi -a,&\qquad b'&=\pi -b,&\qquad c'&=\pi -c,\\a'&=\pi -a,&b'&=\pi -b,&c'&=\pi -c.\end{alignedat}}}
  therefore, if any identity is proved for the triangle abc then we can immediately derive a second identity by applying the first identity to the polar triangle by making the above substitutions. this is how the supplemental cosine equations are derived from the cosine equations. similarly, the identities for a quadrantal triangle can be derived from those for a right-angled triangle. the polar triangle of a polar triangle is the original triangle.


== cosine rules and sine rules ==


=== cosine rules ===

the cosine rule is the fundamental identity of spherical trigonometry: all other identities, including the sine rule, may be derived from the cosine rule:

  
    
      
        cos
        ⁡
        a
        =
        cos
        ⁡
        b
        cos
        ⁡
        c
        +
        sin
        ⁡
        b
        sin
        ⁡
        c
        cos
        ⁡
        a
        ,
        
      
    
    {\displaystyle \cos a=\cos b\cos c+\sin b\sin c\cos a,\!}
  

  
    
      
        cos
        ⁡
        b
        =
        cos
        ⁡
        c
        cos
        ⁡
        a
        +
        sin
        ⁡
        c
        sin
        ⁡
        a
        cos
        ⁡
        b
        ,
        
      
    
    {\displaystyle \cos b=\cos c\cos a+\sin c\sin a\cos b,\!}
  

  
    
      
        cos
        ⁡
        c
        =
        cos
        ⁡
        a
        cos
        ⁡
        b
        +
        sin
        ⁡
        a
        sin
        ⁡
        b
        cos
        ⁡
        c
        ,
        
      
    
    {\displaystyle \cos c=\cos a\cos b+\sin a\sin b\cos c,\!}
  these identities generalize the cosine rule of plane trigonometry, to which they are asymptotically equivalent
in the limit of small interior angles. (on the unit sphere, if 
  
    
      
        a
        ,
        b
        ,
        c
        →
        0
      
    
    {\displaystyle a,b,c\rightarrow 0}
    set 
  
    
      
        sin
        ⁡
        a
        ≈
        a
      
    
    {\displaystyle \sin a\approx a}
   and 
  
    
      
        (
        cos
        ⁡
        a
        −
        cos
        ⁡
        b
        
          )
          
            2
          
        
        ≈
        0
      
    
    {\displaystyle (\cos a-\cos b)^{2}\approx 0}
   etc.; see spherical law of cosines.)


=== sine rules ===

the spherical law of sines is given by the formula

  
    
      
        
          
            
              sin
              ⁡
              a
            
            
              sin
              ⁡
              a
            
          
        
        =
        
          
            
              sin
              ⁡
              b
            
            
              sin
              ⁡
              b
            
          
        
        =
        
          
            
              sin
              ⁡
              c
            
            
              sin
              ⁡
              c
            
          
        
        .
      
    
    {\displaystyle {\frac {\sin a}{\sin a}}={\frac {\sin b}{\sin b}}={\frac {\sin c}{\sin c}}.}
  these identities approximate the sine rule of plane trigonometry when the sides are much smaller than the radius of the sphere.


=== derivation of the cosine rule ===

the spherical cosine formulae were originally proved by elementary geometry and the planar cosine rule (todhunter, art.37). he also gives a derivation using simple coordinate geometry and the planar cosine rule (art.60). the approach outlined here uses simpler vector methods. (these methods are also discussed at spherical law of cosines.)
consider three unit vectors oa, ob and oc drawn from the origin to the vertices of the triangle (on the unit sphere). the arc bc subtends an angle of magnitude a at the centre and therefore ob·oc = cos a. introduce a cartesian basis with oa along the z-axis and ob in the xz-plane making an angle c with the z-axis. the vector oc projects to on in the xy-plane and the angle between on and the x-axis is a. therefore, the three vectors have components:

oa 
  
    
      
        (
        0
        ,
        
        0
        ,
        
        1
        )
      
    
    {\displaystyle (0,\,0,\,1)}
      ob 
  
    
      
        (
        sin
        ⁡
        c
        ,
        
        0
        ,
        
        cos
        ⁡
        c
        )
      
    
    {\displaystyle (\sin c,\,0,\,\cos c)}
      oc 
  
    
      
        (
        sin
        ⁡
        b
        cos
        ⁡
        a
        ,
        
        sin
        ⁡
        b
        sin
        ⁡
        a
        ,
        
        cos
        ⁡
        b
        )
      
    
    {\displaystyle (\sin b\cos a,\,\sin b\sin a,\,\cos b)}
  .the scalar product ob·oc in terms of the components is

ob·oc
  
    
      
        

        
        =
        sin
        ⁡
        c
        sin
        ⁡
        b
        cos
        ⁡
        a
        +
        cos
        ⁡
        c
        cos
        ⁡
        b
      
    
    {\displaystyle {}=\sin c\sin b\cos a+\cos c\cos b}
  .equating the two expressions for the scalar product gives

  
    
      
        cos
        ⁡
        a
        =
        cos
        ⁡
        b
        cos
        ⁡
        c
        +
        sin
        ⁡
        b
        sin
        ⁡
        c
        cos
        ⁡
        a
        .
      
    
    {\displaystyle \cos a=\cos b\cos c+\sin b\sin c\cos a.}
  this equation can be re-arranged to give explicit expressions for the angle in terms of the sides:

  
    
      
        cos
        ⁡
        a
        =
        
          
            
              cos
              ⁡
              a
              −
              cos
              ⁡
              b
              cos
              ⁡
              c
            
            
              sin
              ⁡
              b
              sin
              ⁡
              c
            
          
        
        .
      
    
    {\displaystyle \cos a={\frac {\cos a-\cos b\cos c}{\sin b\sin c}}.}
  the other cosine rules are obtained by cyclic permutations.


=== derivation of the sine rule ===

this derivation is given in todhunter, (art.40). from the identity 
  
    
      
        
          sin
          
            2
          
        
        ⁡
        a
        =
        1
        −
        
          cos
          
            2
          
        
        ⁡
        a
      
    
    {\displaystyle \sin ^{2}a=1-\cos ^{2}a}
   and the explicit expression for 
  
    
      
        cos
        ⁡
        a
      
    
    {\displaystyle \cos a}
   given immediately above

  
    
      
        
          
            
              
                
                  sin
                  
                    2
                  
                
                ⁡
                a
              
              
                
                =
                1
                −
                
                  
                    (
                    
                      
                        
                          cos
                          ⁡
                          a
                          −
                          cos
                          ⁡
                          b
                          cos
                          ⁡
                          c
                        
                        
                          sin
                          ⁡
                          b
                          sin
                          ⁡
                          c
                        
                      
                    
                    )
                  
                  
                    2
                  
                
              
            
            
              
              
                
                =
                
                  
                    
                      (
                      1
                      −
                      
                        cos
                        
                          2
                        
                      
                      ⁡
                      b
                      )
                      (
                      1
                      −
                      
                        cos
                        
                          2
                        
                      
                      ⁡
                      c
                      )
                      −
                      (
                      cos
                      ⁡
                      a
                      −
                      cos
                      ⁡
                      b
                      cos
                      ⁡
                      c
                      
                        )
                        
                          2
                        
                      
                    
                    
                      
                        sin
                        
                          2
                        
                      
                      
                      b
                      
                      
                        sin
                        
                          2
                        
                      
                      
                      c
                    
                  
                
              
            
            
              
                
                  
                    
                      sin
                      ⁡
                      a
                    
                    
                      sin
                      ⁡
                      a
                    
                  
                
              
              
                
                =
                
                  
                    
                      [
                      1
                      −
                      
                        cos
                        
                          2
                        
                      
                      
                      a
                      −
                      
                        cos
                        
                          2
                        
                      
                      
                      b
                      −
                      
                        cos
                        
                          2
                        
                      
                      
                      c
                      +
                      2
                      cos
                      ⁡
                      a
                      cos
                      ⁡
                      b
                      cos
                      ⁡
                      c
                      
                        ]
                        
                          1
                          
                            /
                          
                          2
                        
                      
                    
                    
                      sin
                      ⁡
                      a
                      sin
                      ⁡
                      b
                      sin
                      ⁡
                      c
                    
                  
                
                .
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}\sin ^{2}a&=1-\left({\frac {\cos a-\cos b\cos c}{\sin b\sin c}}\right)^{2}\\[5pt]&={\frac {(1-\cos ^{2}b)(1-\cos ^{2}c)-(\cos a-\cos b\cos c)^{2}}{\sin ^{2}\!b\,\sin ^{2}\!c}}\\[5pt]{\frac {\sin a}{\sin a}}&={\frac {[1-\cos ^{2}\!a-\cos ^{2}\!b-\cos ^{2}\!c+2\cos a\cos b\cos c]^{1/2}}{\sin a\sin b\sin c}}.\end{aligned}}}
  since the right hand side is invariant under a cyclic permutation of 
  
    
      
        a
        ,
        
        b
        ,
        
        c
      
    
    {\displaystyle a,\;b,\;c}
   the spherical sine rule follows immediately.


=== alternative derivations ===
there are many ways of deriving the fundamental cosine and sine rules and the other rules developed in the following sections. for example, todhunter gives two proofs of the cosine rule (articles 37 and 60) and two proofs of the sine rule (articles 40 and 42). the page on spherical law of cosines gives four different proofs of the cosine rule. text books on geodesy (such as clarke) and spherical astronomy (such as smart) give different proofs and the online resources of mathworld provide yet more. there are even more exotic derivations, such as that of banerjee who derives the formulae using the linear algebra of projection matrices and also quotes methods in differential geometry and the group theory of rotations.
the derivation of the cosine rule presented above has the merits of simplicity and directness and the derivation of the sine rule emphasises the fact that no separate proof is required other than the cosine rule. however, the above geometry may be used to give an independent proof of the sine rule.  the scalar triple product, oa·(ob × oc) evaluates to 
  
    
      
        sin
        ⁡
        b
        sin
        ⁡
        c
        sin
        ⁡
        a
      
    
    {\displaystyle \sin b\sin c\sin a}
   in the basis shown. similarly, in a basis oriented with  the z-axis along ob, the triple product ob·(oc × oa) evaluates to 
  
    
      
        sin
        ⁡
        c
        sin
        ⁡
        a
        sin
        ⁡
        b
      
    
    {\displaystyle \sin c\sin a\sin b}
  . therefore, the invariance of the triple product under cyclic permutations gives 
  
    
      
        sin
        ⁡
        b
        sin
        ⁡
        a
        =
        sin
        ⁡
        a
        sin
        ⁡
        b
      
    
    {\displaystyle \sin b\sin a=\sin a\sin b}
   which is the first of the sine rules. see curved variations of the law of sines to see details of this derivation.


== identities ==


=== supplemental cosine rules ===
applying the cosine rules to the polar triangle gives (todhunter, art.47), i.e. replacing a by π – a,  a by π – a etc.,

  
    
      
        
          
            
              
                cos
                ⁡
                a
              
              
                
                =
                −
                cos
                ⁡
                b
                
                cos
                ⁡
                c
                +
                sin
                ⁡
                b
                
                sin
                ⁡
                c
                
                cos
                ⁡
                a
                ,
              
            
            
              
                cos
                ⁡
                b
              
              
                
                =
                −
                cos
                ⁡
                c
                
                cos
                ⁡
                a
                +
                sin
                ⁡
                c
                
                sin
                ⁡
                a
                
                cos
                ⁡
                b
                ,
              
            
            
              
                cos
                ⁡
                c
              
              
                
                =
                −
                cos
                ⁡
                a
                
                cos
                ⁡
                b
                +
                sin
                ⁡
                a
                
                sin
                ⁡
                b
                
                cos
                ⁡
                c
                .
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}\cos a&=-\cos b\,\cos c+\sin b\,\sin c\,\cos a,\\\cos b&=-\cos c\,\cos a+\sin c\,\sin a\,\cos b,\\\cos c&=-\cos a\,\cos b+\sin a\,\sin b\,\cos c.\end{aligned}}}
  


=== cotangent four-part formulae ===
the six parts of a triangle may be written in cyclic order as (acbacb). the cotangent, or four-part, formulae relate two sides and two angles forming four consecutive parts around the triangle, for example (acba) or (bacb). in such a set there are inner and outer parts: for example in the set (bacb) the inner angle is c, the inner side is a, the outer angle is b, the outer side is b. the cotangent rule may be written as (todhunter, art.44)

  
    
      
        cos
        ⁡
        (
        
          
            i
            n
            n
            e
            r
          
        
         
        
          
            s
            i
            d
            e
          
        
        )
        cos
        ⁡
        (
        
          
            i
            n
            n
            e
            r
          
        
         
        
          
            a
            n
            g
            l
            e
          
        
        )
        =
        cot
        ⁡
        (
        
          
            o
            u
            t
            e
            r
          
        
         
        
          
            s
            i
            d
            e
          
        
        )
        sin
        ⁡
        (
        
          
            i
            n
            n
            e
            r
          
        
         
        
          
            s
            i
            d
            e
          
        
        )
        −
        cot
        ⁡
        (
        
          
            o
            u
            t
            e
            r
          
        
         
        
          
            a
            n
            g
            l
            e
          
        
        )
        sin
        ⁡
        (
        
          
            i
            n
            n
            e
            r
          
        
         
        
          
            a
            n
            g
            l
            e
          
        
        )
        ,
      
    
    {\displaystyle \cos({\mathsf {inner}}\ {\mathsf {side}})\cos({\mathsf {inner}}\ {\mathsf {angle}})=\cot({\mathsf {outer}}\ {\mathsf {side}})\sin({\mathsf {inner}}\ {\mathsf {side}})-\cot({\mathsf {outer}}\ {\mathsf {angle}})\sin({\mathsf {inner}}\ {\mathsf {angle}}),}
  and the six possible equations are (with the relevant set shown at right):

  
    
      
        
          
            
              
                
                  (ct1)
                
                
              
              
                cos
                ⁡
                b
                
                cos
                ⁡
                c
                =
                cot
                ⁡
                a
                
                sin
                ⁡
                b
                −
                cot
                ⁡
                a
                
                sin
                ⁡
                c
                ,
                
              
              
                (
                a
                c
                b
                a
                )
              
            
            
              
                
                  (ct2)
                
              
              
                cos
                ⁡
                b
                
                cos
                ⁡
                a
                =
                cot
                ⁡
                c
                
                sin
                ⁡
                b
                −
                cot
                ⁡
                c
                
                sin
                ⁡
                a
                ,
              
              
                (
                c
                b
                a
                c
                )
              
            
            
              
                
                  (ct3)
                
              
              
                cos
                ⁡
                c
                
                cos
                ⁡
                a
                =
                cot
                ⁡
                b
                
                sin
                ⁡
                c
                −
                cot
                ⁡
                b
                
                sin
                ⁡
                a
                ,
              
              
                (
                b
                a
                c
                b
                )
              
            
            
              
                
                  (ct4)
                
              
              
                cos
                ⁡
                c
                
                cos
                ⁡
                b
                =
                cot
                ⁡
                a
                
                sin
                ⁡
                c
                −
                cot
                ⁡
                a
                
                sin
                ⁡
                b
                ,
              
              
                (
                a
                c
                b
                a
                )
              
            
            
              
                
                  (ct5)
                
              
              
                cos
                ⁡
                a
                
                cos
                ⁡
                b
                =
                cot
                ⁡
                c
                
                sin
                ⁡
                a
                −
                cot
                ⁡
                c
                
                sin
                ⁡
                b
                ,
              
              
                (
                c
                b
                a
                c
                )
              
            
            
              
                
                  (ct6)
                
              
              
                cos
                ⁡
                a
                
                cos
                ⁡
                c
                =
                cot
                ⁡
                b
                
                sin
                ⁡
                a
                −
                cot
                ⁡
                b
                
                sin
                ⁡
                c
                ,
              
              
                (
                b
                a
                c
                b
                )
                .
              
            
          
        
      
    
    {\displaystyle {\begin{array}{lll}{\text{(ct1)}}\quad &\cos b\,\cos c=\cot a\,\sin b-\cot a\,\sin c,\qquad &(acba)\\[0ex]{\text{(ct2)}}&\cos b\,\cos a=\cot c\,\sin b-\cot c\,\sin a,&(cbac)\\[0ex]{\text{(ct3)}}&\cos c\,\cos a=\cot b\,\sin c-\cot b\,\sin a,&(bacb)\\[0ex]{\text{(ct4)}}&\cos c\,\cos b=\cot a\,\sin c-\cot a\,\sin b,&(acba)\\[0ex]{\text{(ct5)}}&\cos a\,\cos b=\cot c\,\sin a-\cot c\,\sin b,&(cbac)\\[0ex]{\text{(ct6)}}&\cos a\,\cos c=\cot b\,\sin a-\cot b\,\sin c,&(bacb).\end{array}}}
  to prove the first formula start from the first cosine rule and on the right-hand side substitute for 
  
    
      
        cos
        ⁡
        c
      
    
    {\displaystyle \cos c}
   from the third cosine rule:

  
    
      
        
          
            
              
                cos
                ⁡
                a
              
              
                
                =
                cos
                ⁡
                b
                cos
                ⁡
                c
                +
                sin
                ⁡
                b
                sin
                ⁡
                c
                cos
                ⁡
                a
              
            
            
              
              
                
                =
                cos
                ⁡
                b
                 
                (
                cos
                ⁡
                a
                cos
                ⁡
                b
                +
                sin
                ⁡
                a
                sin
                ⁡
                b
                cos
                ⁡
                c
                )
                +
                sin
                ⁡
                b
                sin
                ⁡
                c
                sin
                ⁡
                a
                cot
                ⁡
                a
              
            
            
              
                cos
                ⁡
                a
                
                  sin
                  
                    2
                  
                
                ⁡
                b
              
              
                
                =
                cos
                ⁡
                b
                sin
                ⁡
                a
                sin
                ⁡
                b
                cos
                ⁡
                c
                +
                sin
                ⁡
                b
                sin
                ⁡
                c
                sin
                ⁡
                a
                cot
                ⁡
                a
                .
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}\cos a&=\cos b\cos c+\sin b\sin c\cos a\\&=\cos b\ (\cos a\cos b+\sin a\sin b\cos c)+\sin b\sin c\sin a\cot a\\\cos a\sin ^{2}b&=\cos b\sin a\sin b\cos c+\sin b\sin c\sin a\cot a.\end{aligned}}}
  the result follows on dividing by 
  
    
      
        sin
        ⁡
        a
        sin
        ⁡
        b
      
    
    {\displaystyle \sin a\sin b}
  . similar techniques
with the other two cosine rules give ct3 and ct5. the other three equations follow by applying rules 1, 3 and 5 to the polar triangle.


=== half-angle and half-side formulae ===
with 
  
    
      
        2
        s
        =
        (
        a
        +
        b
        +
        c
        )
      
    
    {\displaystyle 2s=(a+b+c)}
   and 
  
    
      
        2
        s
        =
        (
        a
        +
        b
        +
        c
        )
        ,
      
    
    {\displaystyle 2s=(a+b+c),}
  

another twelve identities follow by cyclic permutation.
the proof (todhunter, art.49) of the first formula starts from the identity  2sin2(a/2) = 1 – cosa, using the cosine rule to express a in terms of the sides and replacing the sum of two cosines by a product. (see sum-to-product identities.) the second formula starts from the identity  2cos2(a/2) = 1 + cosa, the third is a quotient and the remainder follow by applying the results to the polar triangle.


=== delambre (or gauss) analogies ===

another eight identities follow by cyclic permutation.
proved by expanding the numerators and using the half angle formulae. (todhunter, art.54 and delambre)


=== napier's analogies ===

another eight identities follow by cyclic permutation.
these identities follow by division of the delambre formulae. (todhunter, art.52)


=== napier's rules for right spherical triangles ===

when one of the angles, say c, of a spherical triangle is equal to π/2 the various identities given above are considerably simplified. there are ten identities relating three elements chosen from the set a, b, c, a, b.
napier provided an elegant mnemonic aid for the ten independent equations: the mnemonic is called napier's circle or napier's pentagon (when the circle in the above figure, right, is replaced by a pentagon).
first, write the six parts of the triangle (three vertex angles, three arc angles for the sides) in the order they occur around any circuit of the triangle: for the triangle shown above left, going clockwise starting with  a  gives acbacb. next replace the parts that are not adjacent to c (that is a, c, b) by their complements and then delete the angle c from the list. the remaining parts can then be drawn as five ordered, equal slices of a pentagram, or circle, as shown in the above figure (right). for any choice of three contiguous parts, one (the middle part) will be adjacent to two parts and opposite the other two parts. the ten napier's rules are given by

sine of the middle part = the product of the tangents of the adjacent parts
sine of the middle part = the product of the cosines of the opposite partsfor an example, starting with the sector containing 
  
    
      
        a
      
    
    {\displaystyle a}
   we have:

  
    
      
        sin
        ⁡
        a
        =
        tan
        ⁡
        (
        π
        
          /
        
        2
        −
        b
        )
        
        tan
        ⁡
        b
        =
        cos
        ⁡
        (
        π
        
          /
        
        2
        −
        c
        )
        
        cos
        ⁡
        (
        π
        
          /
        
        2
        −
        a
        )
        =
        cot
        ⁡
        b
        
        tan
        ⁡
        b
        =
        sin
        ⁡
        c
        
        sin
        ⁡
        a
        .
      
    
    {\displaystyle \sin a=\tan(\pi /2-b)\,\tan b=\cos(\pi /2-c)\,\cos(\pi /2-a)=\cot b\,\tan b=\sin c\,\sin a.}
  the full set of rules for the right spherical triangle is (todhunter, art.62)


=== napier's rules for quadrantal triangles ===

a quadrantal spherical triangle is defined  to be a spherical triangle in which one of the sides subtends an angle of π/2 radians at the centre of the sphere: on the unit sphere the side has length π/2. in the case that the side  c has length π/2 on the unit sphere the equations governing the remaining sides and angles may be obtained by applying the rules for the right spherical triangle of the previous section to the polar triangle a'b'c'  with sides a',b',c'  such that a' = π − a,  a'  = π − a etc. the results are:


=== five-part rules ===
substituting the second cosine rule  into the first and simplifying gives:

  
    
      
        cos
        ⁡
        a
        =
        (
        cos
        ⁡
        a
        
        cos
        ⁡
        c
        +
        sin
        ⁡
        a
        
        sin
        ⁡
        c
        
        cos
        ⁡
        b
        )
        cos
        ⁡
        c
        +
        sin
        ⁡
        b
        
        sin
        ⁡
        c
        
        cos
        ⁡
        a
      
    
    {\displaystyle \cos a=(\cos a\,\cos c+\sin a\,\sin c\,\cos b)\cos c+\sin b\,\sin c\,\cos a}
  

  
    
      
        cos
        ⁡
        a
        
        
          sin
          
            2
          
        
        ⁡
        c
        =
        sin
        ⁡
        a
        
        cos
        ⁡
        c
        
        sin
        ⁡
        c
        
        cos
        ⁡
        b
        +
        sin
        ⁡
        b
        
        sin
        ⁡
        c
        
        cos
        ⁡
        a
      
    
    {\displaystyle \cos a\,\sin ^{2}c=\sin a\,\cos c\,\sin c\,\cos b+\sin b\,\sin c\,\cos a}
  cancelling the factor of 
  
    
      
        sin
        ⁡
        c
      
    
    {\displaystyle \sin c}
   gives

  
    
      
        cos
        ⁡
        a
        sin
        ⁡
        c
        =
        sin
        ⁡
        a
        
        cos
        ⁡
        c
        
        cos
        ⁡
        b
        +
        sin
        ⁡
        b
        
        cos
        ⁡
        a
      
    
    {\displaystyle \cos a\sin c=\sin a\,\cos c\,\cos b+\sin b\,\cos a}
  similar substitutions in the other cosine and supplementary cosine formulae give a large variety of 5-part rules. they are rarely used.


=== cagnoli's equation ===
multiplying the first cosine rule  by 
  
    
      
        cos
        ⁡
        a
      
    
    {\displaystyle \cos a}
    gives

  
    
      
        cos
        ⁡
        a
        cos
        ⁡
        a
        =
        cos
        ⁡
        b
        
        cos
        ⁡
        c
        
        cos
        ⁡
        a
        +
        sin
        ⁡
        b
        
        sin
        ⁡
        c
        −
        sin
        ⁡
        b
        
        sin
        ⁡
        c
        
        
          sin
          
            2
          
        
        ⁡
        a
        .
      
    
    {\displaystyle \cos a\cos a=\cos b\,\cos c\,\cos a+\sin b\,\sin c-\sin b\,\sin c\,\sin ^{2}a.}
  similarly multiplying the first supplementary cosine rule  by 
  
    
      
        cos
        ⁡
        a
      
    
    {\displaystyle \cos a}
    yields

  
    
      
        cos
        ⁡
        a
        cos
        ⁡
        a
        =
        −
        cos
        ⁡
        b
        
        cos
        ⁡
        c
        
        cos
        ⁡
        a
        +
        sin
        ⁡
        b
        
        sin
        ⁡
        c
        −
        sin
        ⁡
        b
        
        sin
        ⁡
        c
        
        
          sin
          
            2
          
        
        ⁡
        a
        .
      
    
    {\displaystyle \cos a\cos a=-\cos b\,\cos c\,\cos a+\sin b\,\sin c-\sin b\,\sin c\,\sin ^{2}a.}
  subtracting the two and noting that it follows from the sine rules that 
  
    
      
        sin
        ⁡
        b
        
        sin
        ⁡
        c
        
        
          sin
          
            2
          
        
        ⁡
        a
        =
        sin
        ⁡
        b
        
        sin
        ⁡
        c
        
        
          sin
          
            2
          
        
        ⁡
        a
      
    
    {\displaystyle \sin b\,\sin c\,\sin ^{2}a=\sin b\,\sin c\,\sin ^{2}a}
    produces cagnoli's equation

  
    
      
        sin
        ⁡
        b
        
        sin
        ⁡
        c
        +
        cos
        ⁡
        b
        
        cos
        ⁡
        c
        
        cos
        ⁡
        a
        =
        sin
        ⁡
        b
        
        sin
        ⁡
        c
        −
        cos
        ⁡
        b
        
        cos
        ⁡
        c
        
        cos
        ⁡
        a
      
    
    {\displaystyle \sin b\,\sin c+\cos b\,\cos c\,\cos a=\sin b\,\sin c-\cos b\,\cos c\,\cos a}
  which is a relation between the six parts of the spherical triangle.


== solution of triangles ==


=== oblique triangles ===
the solution of triangles is the principal purpose of spherical trigonometry: given three, four or five elements of the triangle, determine the others. the case of five given elements is trivial, requiring only a single application of the sine rule. for four given elements there is one non-trivial case, which is discussed below. for three given elements there are six cases: three sides, two sides and an included or opposite angle, two angles and an included or opposite side, or three angles. (the last case has no analogue in planar trigonometry.) no single method solves all cases. the figure below shows the seven non-trivial cases: in each case the given sides are marked with a cross-bar and the given angles with an arc. (the given elements are also listed below the triangle).  in the summary notation here such as asa, a refers to a given angle and s refers to a given side, and the sequence of a's and s's in the notation refers to the corresponding sequence in the triangle.

case 1: three sides given (sss).  the cosine rule may be used to give the angles a, b, and c but, to avoid ambiguities, the half angle formulae are preferred.
case 2: two sides and an included angle given (sas). the cosine rule gives a and then we are back to case 1.
case 3: two sides and an opposite angle given (ssa). the sine rule gives c and then we have case 7. there are either one or two solutions.
case 4: two angles and an included side given (asa). the four-part cotangent formulae for sets (cbac) and (bacb) give c and b, then a follows from the sine rule.
case 5: two angles and an opposite side given (aas). the sine rule gives b and then we have case 7 (rotated). there are either one or two solutions.
case 6: three angles given (aaa). the supplemental cosine rule may be used to give the sides a, b, and c but, to avoid ambiguities, the half-side formulae are preferred.
case 7: two angles and two opposite sides given (ssaa). use napier's analogies for a and a; or, use case 3 (ssa) or case 5 (aas).the solution methods listed here are not the only possible choices: many others are possible. in general it is better to choose methods that avoid taking an inverse sine because of the possible ambiguity between an angle and its supplement. the use of half-angle formulae is often advisable because half-angles will be less than π/2 and therefore free from ambiguity. there is a full discussion in todhunter. the article solution of triangles#solving spherical triangles presents variants on these methods with a slightly different notation.
there is a full discussion of the solution of oblique triangles in todhunter.: chap. vi  see also the discussion in ross.


=== solution by right-angled triangles ===
another approach is to split the triangle into two right-angled triangles. for example, take the case 3 example where b, c, b are given. construct the great circle from a that is normal to the side bc at the point d. use napier's rules to solve the triangle abd: use c and b to find the sides ad, bd and the angle bad. then use napier's rules to solve the triangle acd: that is use ad and b to find the side dc and the angles c and dac. the angle a and side a follow by addition.


=== numerical considerations ===
not all of the rules obtained are numerically robust in extreme examples, for example when an angle approaches zero or π. problems and solutions may have to be examined carefully, particularly when writing code to solve an arbitrary triangle.


== area and spherical excess ==

consider an  n-sided spherical polygon and let an denote the n-th interior angle. the area of such a polygon is given by (todhunter, art.99)

  
    
      
        
          area of polygon (on the unit sphere)
        
        ≡
        
          e
          
            n
          
        
        =
        
          (
          
            
              ∑
              
                n
                =
                1
              
              
                n
              
            
            
              a
              
                n
              
            
          
          )
        
        −
        (
        n
        −
        2
        )
        π
        .
      
    
    {\displaystyle {\text{area of polygon (on the unit sphere)}}\equiv e_{n}=\left(\sum _{n=1}^{n}a_{n}\right)-(n-2)\pi .}
  for the case of triangle this reduces to

  
    
      
        
          area of triangle (on the unit sphere)
        
        ≡
        e
        =
        
          e
          
            3
          
        
        =
        a
        +
        b
        +
        c
        −
        π
        ,
      
    
    {\displaystyle {\text{area of triangle (on the unit sphere)}}\equiv e=e_{3}=a+b+c-\pi ,}
  where e is the amount by which the sum of the angles exceeds π radians. the quantity e is called the spherical excess of the triangle. this theorem is named after its author, albert girard. an earlier proof was derived, but not published, by the english mathematician thomas harriot. on a sphere of radius r both of the above area expressions are multiplied by r2. the definition of the excess is independent of the radius of the sphere.
the converse result may be written as

  
    
      
        a
        +
        b
        +
        c
        =
        π
        +
        
          
            
              4
              π
              ×
              
                area of triangle
              
            
            area of the sphere
          
        
        .
      
    
    {\displaystyle a+b+c=\pi +{\frac {4\pi \times {\text{area of triangle}}}{\text{area of the sphere}}}.}
  since the area of a triangle cannot be negative the spherical excess is always positive. it is not necessarily small, because the sum of the angles may attain 5π (3π for proper angles). for example,
an octant of a sphere is a spherical triangle with three right angles, so that the excess is π/2. in practical applications it is often small: for example the triangles of geodetic survey typically have a spherical excess much less than 1' of arc. (rapp
clarke, legendre's theorem on spherical triangles).
on the earth the excess of an equilateral triangle with sides 21.3 km (and area 393 km2) is approximately 1 arc second.
there are many formulae for the excess. for example, todhunter, (art.101—103) gives ten examples including that of l'huilier:

  
    
      
        tan
        ⁡
        
          
            
              1
              4
            
          
        
        e
        =
        
          
            tan
            ⁡
            
              
                
                  1
                  2
                
              
            
            s
            
            tan
            ⁡
            
              
                
                  1
                  2
                
              
            
            (
            s
            −
            a
            )
            
            tan
            ⁡
            
              
                
                  1
                  2
                
              
            
            (
            s
            −
            b
            )
            
            tan
            ⁡
            
              
                
                  1
                  2
                
              
            
            (
            s
            −
            c
            )
          
        
      
    
    {\displaystyle \tan {\tfrac {1}{4}}e={\sqrt {\tan {\tfrac {1}{2}}s\,\tan {\tfrac {1}{2}}(s-a)\,\tan {\tfrac {1}{2}}(s-b)\,\tan {\tfrac {1}{2}}(s-c)}}}
  where 
  
    
      
        s
        =
        (
        a
        +
        b
        +
        c
        )
        
          /
        
        2
      
    
    {\displaystyle s=(a+b+c)/2}
  . because some triangles are badly characterized by
their edges (e.g., if 
  
    
      
        a
        =
        b
        ≈
        
          
            1
            2
          
        
        c
      
    
    {\textstyle a=b\approx {\frac {1}{2}}c}
  ), it is often better to use
the formula for the excess in terms of two edges and their included angle

  
    
      
        tan
        ⁡
        
          
            e
            2
          
        
        =
        
          
            
              tan
              ⁡
              
                
                  1
                  2
                
              
              a
              tan
              ⁡
              
                
                  1
                  2
                
              
              b
              sin
              ⁡
              c
            
            
              1
              +
              tan
              ⁡
              
                
                  1
                  2
                
              
              a
              tan
              ⁡
              
                
                  1
                  2
                
              
              b
              cos
              ⁡
              c
            
          
        
        .
      
    
    {\displaystyle \tan {\frac {e}{2}}={\frac {\tan {\frac {1}{2}}a\tan {\frac {1}{2}}b\sin c}{1+\tan {\frac {1}{2}}a\tan {\frac {1}{2}}b\cos c}}.}
  angle deficit is defined similarly for hyperbolic geometry.


=== from latitude and longitude ===
an example for a spherical quadrangle bounded by a segment of a great circle, two meridians, and the equator is

where 
  
    
      
        φ
        ,
        λ
      
    
    {\displaystyle \varphi ,\lambda }
   denote latitude and longitude. this result is obtained from one of napier's
analogies. in the limit where 
  
    
      
        
          φ
          
            1
          
        
        ,
        
          φ
          
            2
          
        
        ,
        
          λ
          
            2
          
        
        −
        
          λ
          
            1
          
        
      
    
    {\displaystyle \varphi _{1},\varphi _{2},\lambda _{2}-\lambda _{1}}
   are all small, this
reduces to the familiar trapezoidal area, 
  
    
      
        
          e
          
            4
          
        
        ≈
        
          
            1
            2
          
        
        (
        
          φ
          
            2
          
        
        +
        
          φ
          
            1
          
        
        )
        (
        
          λ
          
            2
          
        
        −
        
          λ
          
            1
          
        
        )
      
    
    {\textstyle e_{4}\approx {\frac {1}{2}}(\varphi _{2}+\varphi _{1})(\lambda _{2}-\lambda _{1})}
  .
the area of a polygon can be calculated from individual quadrangles of the above type, from (analogously) individual triangle bounded by a segment of the polygon and two meridians, by a line integral with green's theorem, or via an equal-area projection as commonly done in gis. the other algorithms can still be used with the side lengths calculated using a great-circle distance formula.


== see also ==
air navigation
celestial navigation
ellipsoidal trigonometry
great-circle distance or spherical distance
lenart sphere
schwarz triangle
spherical geometry
spherical polyhedron


== references ==


== external links ==
weisstein, eric w. "spherical trigonometry". mathworld. a more thorough list of identities, with some derivation
weisstein, eric w. "spherical triangle". mathworld. a more thorough list of identities, with some derivation
trisph a free software to solve the spherical triangles, configurable to different practical applications and configured for gnomonic
"revisiting spherical trigonometry with orthogonal projectors" by sudipto banerjee. the paper derives the spherical law of cosines and law of sines using elementary linear algebra and projection matrices.
"a visual proof of girard's theorem". wolfram demonstrations project. by okay arik
"the book of instruction on deviant planes and simple planes", a manuscript in arabic that dates back to 1740 and talks about spherical trigonometry, with diagrams
some algorithms for polygons on a sphere robert g. chamberlain, william h. duquette, jet propulsion laboratory. the paper develops and explains many useful formulae, perhaps with a focus on navigation and cartography.
online computation of spherical triangles