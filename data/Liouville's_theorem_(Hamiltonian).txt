in physics, liouville's theorem, named after the french mathematician joseph liouville, is a key theorem in classical statistical and hamiltonian mechanics. it asserts that the phase-space distribution function is constant along the trajectories of the system—that is that the density of system points in the vicinity of a given system point traveling through phase-space is constant with time. this time-independent density is in statistical mechanics known as the classical a priori probability.there are related mathematical results in symplectic topology and ergodic theory; systems obeying liouville's theorem are examples of incompressible dynamical systems.
there are extensions of liouville's theorem to stochastic systems.


== liouville equations ==

the liouville equation describes the time evolution of the phase space distribution function. although the equation is usually referred to as the "liouville equation", josiah willard gibbs was the first to recognize the importance of this equation as the fundamental equation of statistical mechanics. it is referred to as the liouville equation because its derivation for non-canonical systems utilises an identity first derived by liouville in 1838.
consider a hamiltonian dynamical system with canonical coordinates 
  
    
      
        
          q
          
            i
          
        
      
    
    {\displaystyle q_{i}}
   and conjugate momenta 
  
    
      
        
          p
          
            i
          
        
      
    
    {\displaystyle p_{i}}
  , where 
  
    
      
        i
        =
        1
        ,
        …
        ,
        n
      
    
    {\displaystyle i=1,\dots ,n}
  . then the phase space distribution 
  
    
      
        ρ
        (
        p
        ,
        q
        )
      
    
    {\displaystyle \rho (p,q)}
   determines the probability 
  
    
      
        ρ
        (
        p
        ,
        q
        )
        
        
          
            d
          
          
            n
          
        
        q
        
        
          
            d
          
          
            n
          
        
        p
      
    
    {\displaystyle \rho (p,q)\;\mathrm {d} ^{n}q\,\mathrm {d} ^{n}p}
   that the system will be found in the infinitesimal phase space volume 
  
    
      
        
          
            d
          
          
            n
          
        
        q
        
        
          
            d
          
          
            n
          
        
        p
      
    
    {\displaystyle \mathrm {d} ^{n}q\,\mathrm {d} ^{n}p}
  . the liouville equation governs the evolution of 
  
    
      
        ρ
        (
        p
        ,
        q
        ;
        t
        )
      
    
    {\displaystyle \rho (p,q;t)}
   in time 
  
    
      
        t
      
    
    {\displaystyle t}
  :

  
    
      
        
          
            
              d
              ρ
            
            
              d
              t
            
          
        
        =
        
          
            
              ∂
              ρ
            
            
              ∂
              t
            
          
        
        +
        
          ∑
          
            i
            =
            1
          
          
            n
          
        
        
          (
          
            
              
                
                  ∂
                  ρ
                
                
                  ∂
                  
                    q
                    
                      i
                    
                  
                
              
            
            
              
                
                  
                    q
                    ˙
                  
                
              
              
                i
              
            
            +
            
              
                
                  ∂
                  ρ
                
                
                  ∂
                  
                    p
                    
                      i
                    
                  
                
              
            
            
              
                
                  
                    p
                    ˙
                  
                
              
              
                i
              
            
          
          )
        
        =
        0.
      
    
    {\displaystyle {\frac {d\rho }{dt}}={\frac {\partial \rho }{\partial t}}+\sum _{i=1}^{n}\left({\frac {\partial \rho }{\partial q_{i}}}{\dot {q}}_{i}+{\frac {\partial \rho }{\partial p_{i}}}{\dot {p}}_{i}\right)=0.}
  time derivatives are denoted by dots, and are evaluated according to hamilton's equations for the system. this equation demonstrates the conservation of density in phase space (which was gibbs's name for the theorem). liouville's theorem states that

the distribution function is constant along any trajectory in phase space.a proof of liouville's theorem uses the n-dimensional divergence theorem.  this proof is based on the fact that the evolution of 
  
    
      
        ρ
      
    
    {\displaystyle \rho }
   obeys an 2n-dimensional version of the continuity equation:

  
    
      
        
          
            
              ∂
              ρ
            
            
              ∂
              t
            
          
        
        +
        
          ∑
          
            i
            =
            1
          
          
            n
          
        
        
          (
          
            
              
                
                  ∂
                  (
                  ρ
                  
                    
                      
                        
                          q
                          ˙
                        
                      
                    
                    
                      i
                    
                  
                  )
                
                
                  ∂
                  
                    q
                    
                      i
                    
                  
                
              
            
            +
            
              
                
                  ∂
                  (
                  ρ
                  
                    
                      
                        
                          p
                          ˙
                        
                      
                    
                    
                      i
                    
                  
                  )
                
                
                  ∂
                  
                    p
                    
                      i
                    
                  
                
              
            
          
          )
        
        =
        0.
      
    
    {\displaystyle {\frac {\partial \rho }{\partial t}}+\sum _{i=1}^{n}\left({\frac {\partial (\rho {\dot {q}}_{i})}{\partial q_{i}}}+{\frac {\partial (\rho {\dot {p}}_{i})}{\partial p_{i}}}\right)=0.}
  that is, the 3-tuple 
  
    
      
        (
        ρ
        ,
        ρ
        
          
            
              
                q
                ˙
              
            
          
          
            i
          
        
        ,
        ρ
        
          
            
              
                p
                ˙
              
            
          
          
            i
          
        
        )
      
    
    {\displaystyle (\rho ,\rho {\dot {q}}_{i},\rho {\dot {p}}_{i})}
   is a conserved current. notice that the difference between this and liouville's equation are the terms

  
    
      
        ρ
        
          ∑
          
            i
            =
            1
          
          
            n
          
        
        
          (
          
            
              
                
                  ∂
                  
                    
                      
                        
                          q
                          ˙
                        
                      
                    
                    
                      i
                    
                  
                
                
                  ∂
                  
                    q
                    
                      i
                    
                  
                
              
            
            +
            
              
                
                  ∂
                  
                    
                      
                        
                          p
                          ˙
                        
                      
                    
                    
                      i
                    
                  
                
                
                  ∂
                  
                    p
                    
                      i
                    
                  
                
              
            
          
          )
        
        =
        ρ
        
          ∑
          
            i
            =
            1
          
          
            n
          
        
        
          (
          
            
              
                
                  
                    ∂
                    
                      2
                    
                  
                  h
                
                
                  ∂
                  
                    q
                    
                      i
                    
                  
                  
                  ∂
                  
                    p
                    
                      i
                    
                  
                
              
            
            −
            
              
                
                  
                    ∂
                    
                      2
                    
                  
                  h
                
                
                  ∂
                  
                    p
                    
                      i
                    
                  
                  ∂
                  
                    q
                    
                      i
                    
                  
                
              
            
          
          )
        
        =
        0
        ,
      
    
    {\displaystyle \rho \sum _{i=1}^{n}\left({\frac {\partial {\dot {q}}_{i}}{\partial q_{i}}}+{\frac {\partial {\dot {p}}_{i}}{\partial p_{i}}}\right)=\rho \sum _{i=1}^{n}\left({\frac {\partial ^{2}h}{\partial q_{i}\,\partial p_{i}}}-{\frac {\partial ^{2}h}{\partial p_{i}\partial q_{i}}}\right)=0,}
  where 
  
    
      
        h
      
    
    {\displaystyle h}
   is the hamiltonian, and hamilton's equations as well as conservation of the hamiltonian along the flow have been used. that is, viewing the motion through phase space as a 'fluid flow' of system points, the theorem that the convective derivative of the density, 
  
    
      
        d
        ρ
        
          /
        
        d
        t
      
    
    {\displaystyle d\rho /dt}
  , is zero follows from the equation of continuity by noting that the 'velocity field' 
  
    
      
        (
        
          
            
              p
              ˙
            
          
        
        ,
        
          
            
              q
              ˙
            
          
        
        )
      
    
    {\displaystyle ({\dot {p}},{\dot {q}})}
   in phase space has zero divergence (which follows from hamilton's relations).another illustration is to consider the trajectory of a cloud of points through phase space. it is straightforward to show that as the cloud stretches in one coordinate – 
  
    
      
        
          p
          
            i
          
        
      
    
    {\displaystyle p_{i}}
   say – it shrinks in the corresponding 
  
    
      
        
          q
          
            i
          
        
      
    
    {\displaystyle q^{i}}
   direction so that the product 
  
    
      
        δ
        
          p
          
            i
          
        
        
        δ
        
          q
          
            i
          
        
      
    
    {\displaystyle \delta p_{i}\,\delta q^{i}}
   remains constant.


== other formulations ==


=== poisson bracket ===
the theorem above is often restated in terms of the poisson bracket as

  
    
      
        
          
            
              ∂
              ρ
            
            
              ∂
              t
            
          
        
        =
        −
        {
        
        ρ
        ,
        h
        
        }
      
    
    {\displaystyle {\frac {\partial \rho }{\partial t}}=-\{\,\rho ,h\,\}}
  or, in terms of the linear liouville operator or liouvillian,

  
    
      
        
          i
        
        
          
            
              
                l
              
              ^
            
          
        
        =
        
          ∑
          
            i
            =
            1
          
          
            n
          
        
        
          [
          
            
              
                
                  ∂
                  h
                
                
                  ∂
                  
                    p
                    
                      i
                    
                  
                
              
            
            
              
                ∂
                
                  ∂
                  
                    q
                    
                      i
                    
                  
                
              
            
            −
            
              
                
                  ∂
                  h
                
                
                  ∂
                  
                    q
                    
                      i
                    
                  
                
              
            
            
              
                ∂
                
                  ∂
                  
                    p
                    
                      i
                    
                  
                
              
            
          
          ]
        
        =
        {
        ∙
        ,
        h
        }
      
    
    {\displaystyle \mathrm {i} {\widehat {\mathbf {l} }}=\sum _{i=1}^{n}\left[{\frac {\partial h}{\partial p_{i}}}{\frac {\partial }{\partial q^{i}}}-{\frac {\partial h}{\partial q^{i}}}{\frac {\partial }{\partial p_{i}}}\right]=\{\bullet ,h\}}
  as

  
    
      
        
          
            
              ∂
              ρ
            
            
              ∂
              t
            
          
        
        +
        
          
            i
          
          
            
              
                
                  l
                
                ^
              
            
          
        
        ρ
        =
        0.
      
    
    {\displaystyle {\frac {\partial \rho }{\partial t}}+{\mathrm {i} {\widehat {\mathbf {l} }}}\rho =0.}
  


=== ergodic theory ===
in ergodic theory and dynamical systems, motivated by the physical considerations given so far, there is a corresponding result also referred to as liouville's theorem. in hamiltonian mechanics, the phase space is a smooth manifold that comes naturally equipped with a smooth measure (locally, this measure is the 6n-dimensional lebesgue measure). the theorem says this smooth measure is invariant under the hamiltonian flow. more generally, one can describe the necessary and sufficient condition under which a smooth measure is invariant under a flow. the hamiltonian case then becomes a corollary.


=== symplectic geometry ===
we can also formulate liouville's theorem in terms of symplectic geometry. for a given system, we can consider the phase space 
  
    
      
        (
        
          q
          
            μ
          
        
        ,
        
          p
          
            μ
          
        
        )
      
    
    {\displaystyle (q^{\mu },p_{\mu })}
   of a particular hamiltonian 
  
    
      
        h
      
    
    {\displaystyle h}
   as a manifold 
  
    
      
        (
        m
        ,
        ω
        )
      
    
    {\displaystyle (m,\omega )}
   endowed with a symplectic 2-form

  
    
      
        ω
        =
        d
        
          p
          
            μ
          
        
        ∧
        d
        
          q
          
            μ
          
        
        .
      
    
    {\displaystyle \omega =dp_{\mu }\wedge dq^{\mu }.}
  the volume form of our manifold is the top exterior power of the symplectic 2-form, and is just another representation of the measure on the phase space described above.
on our phase space symplectic manifold we can define a hamiltonian vector field generated by a function 
  
    
      
        f
        (
        q
        ,
        p
        )
      
    
    {\displaystyle f(q,p)}
   as

  
    
      
        
          x
          
            f
          
        
        =
        
          
            
              ∂
              f
            
            
              ∂
              
                p
                
                  μ
                
              
            
          
        
        
          
            ∂
            
              ∂
              
                q
                
                  μ
                
              
            
          
        
        −
        
          
            
              ∂
              f
            
            
              ∂
              
                q
                
                  μ
                
              
            
          
        
        
          
            ∂
            
              ∂
              
                p
                
                  μ
                
              
            
          
        
        .
      
    
    {\displaystyle x_{f}={\frac {\partial f}{\partial p_{\mu }}}{\frac {\partial }{\partial q^{\mu }}}-{\frac {\partial f}{\partial q^{\mu }}}{\frac {\partial }{\partial p_{\mu }}}.}
  specifically, when the generating function is the hamiltonian itself, 
  
    
      
        f
        (
        q
        ,
        p
        )
        =
        h
      
    
    {\displaystyle f(q,p)=h}
  , we get

  
    
      
        
          x
          
            h
          
        
        =
        
          
            
              ∂
              h
            
            
              ∂
              
                p
                
                  μ
                
              
            
          
        
        
          
            ∂
            
              ∂
              
                q
                
                  μ
                
              
            
          
        
        −
        
          
            
              ∂
              h
            
            
              ∂
              
                q
                
                  μ
                
              
            
          
        
        
          
            ∂
            
              ∂
              
                p
                
                  μ
                
              
            
          
        
        =
        
          
            
              d
              
                q
                
                  μ
                
              
            
            
              d
              t
            
          
        
        
          
            ∂
            
              ∂
              
                q
                
                  μ
                
              
            
          
        
        +
        
          
            
              d
              
                p
                
                  μ
                
              
            
            
              d
              t
            
          
        
        
          
            ∂
            
              ∂
              
                p
                
                  μ
                
              
            
          
        
        =
        
          
            d
            
              d
              t
            
          
        
      
    
    {\displaystyle x_{h}={\frac {\partial h}{\partial p_{\mu }}}{\frac {\partial }{\partial q^{\mu }}}-{\frac {\partial h}{\partial q^{\mu }}}{\frac {\partial }{\partial p_{\mu }}}={\frac {dq^{\mu }}{dt}}{\frac {\partial }{\partial q^{\mu }}}+{\frac {dp^{\mu }}{dt}}{\frac {\partial }{\partial p_{\mu }}}={\frac {d}{dt}}}
  where we utilized hamilton's equations of motion and the definition of the chain rule.in this formalism, liouville's theorem states that the lie derivative of the volume form is zero along the flow generated by 
  
    
      
        
          x
          
            h
          
        
      
    
    {\displaystyle x_{h}}
  . that is, for 
  
    
      
        (
        m
        ,
        ω
        )
      
    
    {\displaystyle (m,\omega )}
   a 2n-dimensional symplectic manifold,

  
    
      
        
          
            
              l
            
          
          
            
              x
              
                h
              
            
          
        
        (
        
          ω
          
            n
          
        
        )
        =
        0.
      
    
    {\displaystyle {\mathcal {l}}_{x_{h}}(\omega ^{n})=0.}
  in fact, the symplectic structure 
  
    
      
        ω
      
    
    {\displaystyle \omega }
   itself is preserved, not only its top exterior power. that is, liouville's theorem also gives 

  
    
      
        
          
            
              l
            
          
          
            
              x
              
                h
              
            
          
        
        (
        ω
        )
        =
        0.
      
    
    {\displaystyle {\mathcal {l}}_{x_{h}}(\omega )=0.}
  


=== quantum liouville equation ===
the analog of liouville equation in quantum mechanics describes the time evolution of a mixed state.  canonical quantization yields a quantum-mechanical version of this theorem, the von neumann equation.  this procedure, often used to devise quantum analogues of classical systems, involves describing a classical system using hamiltonian mechanics.  classical variables are then re-interpreted as quantum operators, while poisson brackets are replaced by commutators.  in this case, the resulting equation is

  
    
      
        
          
            
              ∂
              ρ
            
            
              ∂
              t
            
          
        
        =
        
          
            1
            
              i
              ℏ
            
          
        
        [
        h
        ,
        ρ
        ]
      
    
    {\displaystyle {\frac {\partial \rho }{\partial t}}={\frac {1}{i\hbar }}[h,\rho ]}
  where ρ is the density matrix.
when applied to the expectation value of an observable, the corresponding equation is given by ehrenfest's theorem, and takes the form

  
    
      
        
          
            d
            
              d
              t
            
          
        
        ⟨
        a
        ⟩
        =
        −
        
          
            1
            
              i
              ℏ
            
          
        
        ⟨
        [
        h
        ,
        a
        ]
        ⟩
      
    
    {\displaystyle {\frac {d}{dt}}\langle a\rangle =-{\frac {1}{i\hbar }}\langle [h,a]\rangle }
  where 
  
    
      
        a
      
    
    {\displaystyle a}
   is an observable. note the sign difference, which follows from the assumption that the operator is stationary and the state is time-dependent.
in the phase space formulation of quantum mechanics, substituting the moyal brackets for poisson brackets in the phase-space analog of the von neumann equation results in compressibility of the probability fluid, and thus violations of liouville's theorem incompressibility. this, then, leads to concomitant difficulties in defining meaningful quantum trajectories.


== examples ==


=== sho phase space volume ===

consider an 
  
    
      
        n
      
    
    {\displaystyle n}
   particle system in three dimensions, and focus on only the evolution of 
  
    
      
        
          d
        
        
          
            n
          
        
      
    
    {\displaystyle \mathrm {d} {\mathcal {n}}}
   particles. within phase space, these 
  
    
      
        
          d
        
        
          
            n
          
        
      
    
    {\displaystyle \mathrm {d} {\mathcal {n}}}
   particles occupy an infinitesimal volume given by

  
    
      
        
          d
        
        γ
        =
        
          
            ∏
            
              i
              =
              1
            
            
              n
            
          
          
            d
            
              3
            
          
          
            p
            
              i
            
          
          
            d
            
              3
            
          
          
            q
            
              i
            
          
          .
        
      
    
    {\displaystyle \mathrm {d} \gamma =\displaystyle \prod _{i=1}^{n}d^{3}p_{i}d^{3}q_{i}.}
  we want 
  
    
      
        
          
            
              
                d
              
              
                
                  n
                
              
            
            
              
                d
              
              γ
            
          
        
      
    
    {\displaystyle {\frac {\mathrm {d} {\mathcal {n}}}{\mathrm {d} \gamma }}}
   to remain the same throughout time, so that 
  
    
      
        ρ
        (
        γ
        ,
        t
        )
      
    
    {\displaystyle \rho (\gamma ,t)}
   is constant along the trajectories of the system. if we allow our particles to evolve by an infinitesimal time step 
  
    
      
        δ
        t
      
    
    {\displaystyle \delta t}
  , we see that each particle phase space location changes as

  
    
      
        
          
            {
            
              
                
                  
                    q
                    
                      i
                    
                    ′
                  
                  =
                  
                    q
                    
                      i
                    
                  
                  +
                  
                    
                      
                        
                          q
                          
                            i
                          
                        
                        ˙
                      
                    
                  
                  δ
                  t
                
              
              
                
                  
                    p
                    
                      i
                    
                    ′
                  
                  =
                  
                    p
                    
                      i
                    
                  
                  +
                  
                    
                      
                        
                          p
                          
                            i
                          
                        
                        ˙
                      
                    
                  
                  δ
                  t
                  ,
                
              
            
            
          
        
      
    
    {\displaystyle {\begin{cases}q_{i}'=q_{i}+{\dot {q_{i}}}\delta t\\p_{i}'=p_{i}+{\dot {p_{i}}}\delta t,\end{cases}}}
  where 
  
    
      
        
          
            
              
                q
                
                  i
                
              
              ˙
            
          
        
      
    
    {\displaystyle {\dot {q_{i}}}}
   and 
  
    
      
        
          
            
              
                p
                
                  i
                
              
              ˙
            
          
        
      
    
    {\displaystyle {\dot {p_{i}}}}
   denote 
  
    
      
        
          
            
              d
              
                q
                
                  i
                
              
            
            
              d
              t
            
          
        
      
    
    {\displaystyle {\frac {dq_{i}}{dt}}}
   and 
  
    
      
        
          
            
              d
              
                p
                
                  i
                
              
            
            
              d
              t
            
          
        
      
    
    {\displaystyle {\frac {dp_{i}}{dt}}}
   respectively, and we have only kept terms linear in 
  
    
      
        δ
        t
      
    
    {\displaystyle \delta t}
  . extending this to our infinitesimal hypercube 
  
    
      
        
          d
        
        γ
      
    
    {\displaystyle \mathrm {d} \gamma }
  , the side lengths change as

  
    
      
        
          
            {
            
              
                
                  d
                  
                    q
                    
                      i
                    
                    ′
                  
                  =
                  d
                  
                    q
                    
                      i
                    
                  
                  +
                  
                    
                      
                        ∂
                        
                          
                            
                              
                                q
                                
                                  i
                                
                              
                              ˙
                            
                          
                        
                      
                      
                        ∂
                        
                          q
                          
                            i
                          
                        
                      
                    
                  
                  d
                  
                    q
                    
                      i
                    
                  
                  δ
                  t
                
              
              
                
                  d
                  
                    p
                    
                      i
                    
                    ′
                  
                  =
                  d
                  
                    p
                    
                      i
                    
                  
                  +
                  
                    
                      
                        ∂
                        
                          
                            
                              
                                p
                                
                                  i
                                
                              
                              ˙
                            
                          
                        
                      
                      
                        ∂
                        
                          p
                          
                            i
                          
                        
                      
                    
                  
                  d
                  
                    p
                    
                      i
                    
                  
                  δ
                  t
                  .
                
              
            
            
          
        
      
    
    {\displaystyle {\begin{cases}dq_{i}'=dq_{i}+{\frac {\partial {\dot {q_{i}}}}{\partial q_{i}}}dq_{i}\delta t\\dp_{i}'=dp_{i}+{\frac {\partial {\dot {p_{i}}}}{\partial p_{i}}}dp_{i}\delta t.\end{cases}}}
  to find the new infinitesimal phase space volume 
  
    
      
        
          d
        
        
          γ
          ′
        
      
    
    {\displaystyle \mathrm {d} \gamma '}
  , we need the product of the above quantities. to first order in 
  
    
      
        δ
        t
      
    
    {\displaystyle \delta t}
  , we get the following.

  
    
      
        d
        
          q
          
            i
          
          ′
        
        d
        
          p
          
            i
          
          ′
        
        =
        d
        
          q
          
            i
          
        
        d
        
          p
          
            i
          
        
        
          [
          
            1
            +
            
              (
              
                
                  
                    
                      ∂
                      
                        
                          
                            
                              q
                              
                                i
                              
                            
                            ˙
                          
                        
                      
                    
                    
                      ∂
                      
                        q
                        
                          i
                        
                      
                    
                  
                
                +
                
                  
                    
                      ∂
                      
                        
                          
                            
                              p
                              
                                i
                              
                            
                            ˙
                          
                        
                      
                    
                    
                      ∂
                      
                        p
                        
                          i
                        
                      
                    
                  
                
              
              )
            
            δ
            t
          
          ]
        
      
    
    {\displaystyle dq_{i}'dp_{i}'=dq_{i}dp_{i}\left[1+\left({\frac {\partial {\dot {q_{i}}}}{\partial q_{i}}}+{\frac {\partial {\dot {p_{i}}}}{\partial p_{i}}}\right)\delta t\right]}
  so far, we have yet to make any specifications about our system. let us now specialize to the case of 
  
    
      
        n
      
    
    {\displaystyle n}
   
  
    
      
        3
      
    
    {\displaystyle 3}
  -dimensional isotropic harmonic oscillators. that is, each particle in our ensemble can be treated as a simple harmonic oscillator. the hamiltonian for this system is given by

  
    
      
        h
        =
        
          
            ∑
            
              i
              =
              1
            
            
              3
              n
            
          
          
            (
            
              
                
                  1
                  
                    2
                    m
                  
                
              
              
                p
                
                  i
                
                
                  2
                
              
              +
              
                
                  
                    m
                    
                      ω
                      
                        2
                      
                    
                  
                  2
                
              
              
                q
                
                  i
                
                
                  2
                
              
            
            )
          
        
      
    
    {\displaystyle h=\displaystyle \sum _{i=1}^{3n}\left({\frac {1}{2m}}p_{i}^{2}+{\frac {m\omega ^{2}}{2}}q_{i}^{2}\right)}
  by using hamilton's equations with the above hamiltonian we find that the term in parentheses above is identically zero, thus yielding

  
    
      
        d
        
          q
          
            i
          
          ′
        
        d
        
          p
          
            i
          
          ′
        
        =
        d
        
          q
          
            i
          
        
        d
        
          p
          
            i
          
        
        .
      
    
    {\displaystyle dq_{i}'dp_{i}'=dq_{i}dp_{i}.}
  from this we can find the infinitesimal volume of phase space.

  
    
      
        
          d
        
        
          γ
          ′
        
        =
        
          
            ∏
            
              i
              =
              1
            
            
              n
            
          
          
            d
            
              3
            
          
          
            q
            
              i
            
            ′
          
          
            d
            
              3
            
          
          
            p
            
              i
            
            ′
          
          =
          
            ∏
            
              i
              =
              1
            
            
              n
            
          
          
            d
            
              3
            
          
          
            q
            
              i
            
          
          
            d
            
              3
            
          
          
            p
            
              i
            
          
          =
          
            d
          
          γ
        
      
    
    {\displaystyle \mathrm {d} \gamma '=\displaystyle \prod _{i=1}^{n}d^{3}q_{i}'d^{3}p_{i}'=\prod _{i=1}^{n}d^{3}q_{i}d^{3}p_{i}=\mathrm {d} \gamma }
  thus we have ultimately found that the infinitesimal phase space volume is unchanged, yielding

  
    
      
        ρ
        (
        
          γ
          ′
        
        ,
        t
        +
        δ
        t
        )
        =
        
          
            
              
                d
              
              
                
                  n
                
              
            
            
              
                d
              
              
                γ
                ′
              
            
          
        
        =
        
          
            
              
                d
              
              
                
                  n
                
              
            
            
              
                d
              
              γ
            
          
        
        =
        ρ
        (
        γ
        ,
        t
        )
        ,
      
    
    {\displaystyle \rho (\gamma ',t+\delta t)={\frac {\mathrm {d} {\mathcal {n}}}{\mathrm {d} \gamma '}}={\frac {\mathrm {d} {\mathcal {n}}}{\mathrm {d} \gamma }}=\rho (\gamma ,t),}
  demonstrating liouville's theorem holds for this system.the question remains of how the phase space volume actually evolves in time. above we have shown that the total volume is conserved, but said nothing about what it looks like. for a single particle we can see that its trajectory in phase space is given by the ellipse of constant 
  
    
      
        h
      
    
    {\displaystyle h}
  . explicitly, one can solve hamilton's equations for the system and find

  
    
      
        
          
            
              
                
                  q
                  
                    i
                  
                
                (
                t
                )
              
              
                
                =
                
                  q
                  
                    i
                  
                
                cos
                ⁡
                
                  ω
                  t
                
                +
                
                  
                    
                      p
                      
                        i
                      
                    
                    
                      m
                      ω
                    
                  
                
                sin
                ⁡
                
                  ω
                  t
                
              
            
            
              
                
                  p
                  
                    i
                  
                
                (
                t
                )
              
              
                
                =
                
                  p
                  
                    i
                  
                
                cos
                ⁡
                
                  ω
                  t
                
                −
                m
                ω
                
                  q
                  
                    i
                  
                
                sin
                ⁡
                
                  ω
                  t
                
                ,
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}q_{i}(t)&=q_{i}\cos {\omega t}+{\frac {p_{i}}{m\omega }}\sin {\omega t}\\p_{i}(t)&=p_{i}\cos {\omega t}-m\omega q_{i}\sin {\omega t},\end{aligned}}}
  where 
  
    
      
        
          q
          
            i
          
        
      
    
    {\displaystyle q_{i}}
   and 
  
    
      
        
          p
          
            i
          
        
      
    
    {\displaystyle p_{i}}
   denote the initial position and momentum of the 
  
    
      
        
          i
          
            
              t
              h
            
          
        
      
    
    {\displaystyle i^{\mathrm {th} }}
   particle.
for a system of multiple particles, each one will have a phase space trajectory that traces out an ellipse corresponding to the particle's energy. the frequency at which the ellipse is traced is given by the 
  
    
      
        ω
      
    
    {\displaystyle \omega }
   in the hamiltonian, independent of any differences in energy. as a result a region of phase space will simply rotate about the point 
  
    
      
        (
        
          q
        
        ,
        
          p
        
        )
        =
        (
        0
        ,
        0
        )
      
    
    {\displaystyle (\mathbf {q} ,\mathbf {p} )=(0,0)}
   with frequency dependent on 
  
    
      
        ω
      
    
    {\displaystyle \omega }
  . this can be seen in the animation above.


=== damped harmonic oscillator ===

one of the foundational assumptions of liouville's theorem is that the system obeys the conservation of energy. in the context of phase space, this is to say that 
  
    
      
        ρ
      
    
    {\displaystyle \rho }
   is constant on phase space surfaces of constant energy 
  
    
      
        e
      
    
    {\displaystyle e}
  . if we break this requirement by considering a system in which energy is not conserved, we find that 
  
    
      
        ρ
      
    
    {\displaystyle \rho }
   also fails to be constant.
as an example of this, consider again the system of 
  
    
      
        n
      
    
    {\displaystyle n}
   particles each in a 
  
    
      
        3
      
    
    {\displaystyle 3}
  -dimensional isotropic harmonic potential, the hamiltonian for which is given in the previous example. this time, we add the condition that each particle experiences a frictional force. as this is a non-conservative force, we need to extend hamilton's equations as

  
    
      
        
          
            
              
                
                  
                    
                      
                        q
                        
                          i
                        
                      
                      ˙
                    
                  
                
              
              
                
                =
                
                  
                    
                      ∂
                      h
                    
                    
                      ∂
                      
                        p
                        
                          i
                        
                      
                    
                  
                
              
            
            
              
                
                  
                    
                      
                        p
                        
                          i
                        
                      
                      ˙
                    
                  
                
              
              
                
                =
                −
                
                  
                    
                      ∂
                      h
                    
                    
                      ∂
                      
                        q
                        
                          i
                        
                      
                    
                  
                
                −
                γ
                
                  p
                  
                    i
                  
                
                ,
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}{\dot {q_{i}}}&={\frac {\partial h}{\partial p_{i}}}\\{\dot {p_{i}}}&=-{\frac {\partial h}{\partial q_{i}}}-\gamma p_{i},\end{aligned}}}
  where 
  
    
      
        γ
      
    
    {\displaystyle \gamma }
   is a positive constant dictating the amount of friction. following a very similar procedure to the undamped harmonic oscillator case, we arrive again at

  
    
      
        d
        
          q
          
            i
          
          ′
        
        d
        
          p
          
            i
          
          ′
        
        =
        d
        
          q
          
            i
          
        
        d
        
          p
          
            i
          
        
        
          [
          
            1
            +
            
              (
              
                
                  
                    
                      ∂
                      
                        
                          
                            
                              q
                              
                                i
                              
                            
                            ˙
                          
                        
                      
                    
                    
                      ∂
                      
                        q
                        
                          i
                        
                      
                    
                  
                
                +
                
                  
                    
                      ∂
                      
                        
                          
                            
                              p
                              
                                i
                              
                            
                            ˙
                          
                        
                      
                    
                    
                      ∂
                      
                        p
                        
                          i
                        
                      
                    
                  
                
              
              )
            
            δ
            t
          
          ]
        
        .
      
    
    {\displaystyle dq_{i}'dp_{i}'=dq_{i}dp_{i}\left[1+\left({\frac {\partial {\dot {q_{i}}}}{\partial q_{i}}}+{\frac {\partial {\dot {p_{i}}}}{\partial p_{i}}}\right)\delta t\right].}
  plugging in our modified hamilton's equations, we find

  
    
      
        
          
            
              
                d
                
                  q
                  
                    i
                  
                  ′
                
                d
                
                  p
                  
                    i
                  
                  ′
                
              
              
                
                =
                d
                
                  q
                  
                    i
                  
                
                d
                
                  p
                  
                    i
                  
                
                
                  [
                  
                    1
                    +
                    
                      (
                      
                        
                          
                            
                              
                                ∂
                                
                                  2
                                
                              
                              h
                            
                            
                              ∂
                              
                                q
                                
                                  i
                                
                              
                              ∂
                              
                                p
                                
                                  i
                                
                              
                            
                          
                        
                        −
                        
                          
                            
                              
                                ∂
                                
                                  2
                                
                              
                              h
                            
                            
                              ∂
                              
                                p
                                
                                  i
                                
                              
                              ∂
                              
                                q
                                
                                  i
                                
                              
                            
                          
                        
                        −
                        γ
                      
                      )
                    
                    δ
                    t
                  
                  ]
                
              
            
            
              
              
                
                =
                d
                
                  q
                  
                    i
                  
                
                d
                
                  p
                  
                    i
                  
                
                
                  [
                  
                    1
                    −
                    γ
                    δ
                    t
                  
                  ]
                
                .
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}dq_{i}'dp_{i}'&=dq_{i}dp_{i}\left[1+\left({\frac {\partial ^{2}h}{\partial q_{i}\partial p_{i}}}-{\frac {\partial ^{2}h}{\partial p_{i}\partial q_{i}}}-\gamma \right)\delta t\right]\\&=dq_{i}dp_{i}\left[1-\gamma \delta t\right].\end{aligned}}}
  calculating our new infinitesimal phase space volume, and keeping only first order in 
  
    
      
        δ
        t
      
    
    {\displaystyle \delta t}
   we find the following result.

  
    
      
        
          d
        
        
          γ
          ′
        
        =
        
          
            ∏
            
              i
              =
              1
            
            
              n
            
          
          
            d
            
              3
            
          
          
            q
            
              i
            
            ′
          
          
            d
            
              3
            
          
          
            p
            
              i
            
            ′
          
          =
          
            
              [
              
                1
                −
                γ
                δ
                t
              
              ]
            
            
              3
              n
            
          
          
            ∏
            
              i
              =
              1
            
            
              n
            
          
          
            d
            
              3
            
          
          
            q
            
              i
            
          
          
            d
            
              3
            
          
          
            p
            
              i
            
          
          =
          
            d
          
          γ
          
            [
            
              1
              −
              3
              n
              γ
              δ
              t
            
            ]
          
        
      
    
    {\displaystyle \mathrm {d} \gamma '=\displaystyle \prod _{i=1}^{n}d^{3}q_{i}'d^{3}p_{i}'=\left[1-\gamma \delta t\right]^{3n}\prod _{i=1}^{n}d^{3}q_{i}d^{3}p_{i}=\mathrm {d} \gamma \left[1-3n\gamma \delta t\right]}
  we have found that the infinitesimal phase space volume is no longer constant, and thus the phase space density is not conserved. as can be seen from the equation as time increases, we expect our phase space volume to decrease to zero as friction affects the system.
as for how the phase space volume evolves in time, we will still have the constant rotation as in the undamped case. however, the damping will introduce a steady decrease in the radii of each ellipse. again we can solve for the trajectories explicitly using hamilton's equations, taking care to use the modified ones above. letting 
  
    
      
        α
        ≡
        
          
            γ
            2
          
        
      
    
    {\displaystyle \alpha \equiv {\frac {\gamma }{2}}}
   for convenience, we find

  
    
      
        
          
            
              
                
                  q
                  
                    i
                  
                
                (
                t
                )
              
              
                
                =
                
                  e
                  
                    −
                    α
                    t
                  
                
                
                  [
                  
                    
                      q
                      
                        i
                      
                    
                    cos
                    ⁡
                    
                      
                        ω
                        
                          1
                        
                      
                      t
                    
                    +
                    
                      b
                      
                        i
                      
                    
                    sin
                    ⁡
                    
                      
                        ω
                        
                          1
                        
                      
                      t
                    
                  
                  ]
                
              
              
              
                
                  ω
                  
                    1
                  
                
                ≡
                
                  
                    
                      ω
                      
                        2
                      
                    
                    −
                    
                      α
                      
                        2
                      
                    
                  
                
              
            
            
              
                
                  p
                  
                    i
                  
                
                (
                t
                )
              
              
                
                =
                
                  e
                  
                    −
                    α
                    t
                  
                
                
                  [
                  
                    
                      p
                      
                        i
                      
                    
                    cos
                    ⁡
                    
                      
                        ω
                        
                          1
                        
                      
                      t
                    
                    −
                    m
                    (
                    
                      ω
                      
                        1
                      
                    
                    
                      q
                      
                        i
                      
                    
                    +
                    2
                    α
                    
                      b
                      
                        i
                      
                    
                    )
                    sin
                    ⁡
                    
                      
                        ω
                        
                          1
                        
                      
                      t
                    
                  
                  ]
                
              
              
              
                
                  b
                  
                    i
                  
                
                ≡
                
                  
                    1
                    
                      ω
                      
                        1
                      
                    
                  
                
                
                  (
                  
                    
                      
                        
                          p
                          
                            i
                          
                        
                        m
                      
                    
                    +
                    2
                    α
                    
                      q
                      
                        i
                      
                    
                  
                  )
                
                ,
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}q_{i}(t)&=e^{-\alpha t}\left[q_{i}\cos {\omega _{1}t}+b_{i}\sin {\omega _{1}t}\right]&&\omega _{1}\equiv {\sqrt {\omega ^{2}-\alpha ^{2}}}\\p_{i}(t)&=e^{-\alpha t}\left[p_{i}\cos {\omega _{1}t}-m(\omega _{1}q_{i}+2\alpha b_{i})\sin {\omega _{1}t}\right]&&b_{i}\equiv {\frac {1}{\omega _{1}}}\left({\frac {p_{i}}{m}}+2\alpha q_{i}\right),\end{aligned}}}
  where the values 
  
    
      
        
          q
          
            i
          
        
      
    
    {\displaystyle q_{i}}
   and 
  
    
      
        
          p
          
            i
          
        
      
    
    {\displaystyle p_{i}}
   denote the initial position and momentum of the 
  
    
      
        
          i
          
            
              t
              h
            
          
        
      
    
    {\displaystyle i^{\mathrm {th} }}
   particle.
as the system evolves the total phase space volume will spiral in to the origin. this can be seen in the figure above.


== remarks ==
the liouville equation is valid for both equilibrium and nonequilibrium systems. it is a fundamental equation of non-equilibrium statistical mechanics.
the liouville equation is integral to the proof of the fluctuation theorem from which the second law of thermodynamics can be derived.  it is also the key component of the derivation of green–kubo relations for linear transport coefficients such as shear viscosity, thermal conductivity or electrical conductivity.
virtually any textbook on hamiltonian mechanics, advanced statistical mechanics, or symplectic geometry will derive the liouville theorem.


== see also ==
boltzmann transport equation
reversible reference system propagation algorithm (r-respa)


== references ==


== further reading ==
murugeshan, r. modern physics. s. chand.
misner; thorne; wheeler (1973). "kinetic theory in curved spacetime". gravitation. freeman. pp. 583–590. isbn 9781400889099.


== external links ==
"phase space distribution functions and liouville's theorem".