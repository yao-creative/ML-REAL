discrete morse theory is a combinatorial adaptation of morse theory developed by robin forman. the theory has various practical applications in diverse fields of applied mathematics and computer science, such as configuration spaces, homology computation, denoising, mesh compression, and topological data analysis.


== notation regarding cw complexes ==
let 
  
    
      
        x
      
    
    {\displaystyle x}
   be a cw complex and denote by 
  
    
      
        
          
            x
          
        
      
    
    {\displaystyle {\mathcal {x}}}
   its set of cells. define the incidence function 
  
    
      
        κ
        :
        
          
            x
          
        
        ×
        
          
            x
          
        
        →
        
          z
        
      
    
    {\displaystyle \kappa :{\mathcal {x}}\times {\mathcal {x}}\to \mathbb {z} }
   in the following way: given two cells 
  
    
      
        σ
      
    
    {\displaystyle \sigma }
   and 
  
    
      
        τ
      
    
    {\displaystyle \tau }
   in 
  
    
      
        
          
            x
          
        
      
    
    {\displaystyle {\mathcal {x}}}
  , let 
  
    
      
        κ
        (
        σ
        ,
         
        τ
        )
      
    
    {\displaystyle \kappa (\sigma ,~\tau )}
   be the degree of the attaching map from the boundary of 
  
    
      
        σ
      
    
    {\displaystyle \sigma }
   to 
  
    
      
        τ
      
    
    {\displaystyle \tau }
  . the boundary operator is the endomorphism 
  
    
      
        ∂
      
    
    {\displaystyle \partial }
    of the free abelian group generated by 
  
    
      
        
          
            x
          
        
      
    
    {\displaystyle {\mathcal {x}}}
   defined by

  
    
      
        ∂
        (
        σ
        )
        =
        
          ∑
          
            τ
            ∈
            
              
                x
              
            
          
        
        κ
        (
        σ
        ,
        τ
        )
        τ
        .
      
    
    {\displaystyle \partial (\sigma )=\sum _{\tau \in {\mathcal {x}}}\kappa (\sigma ,\tau )\tau .}
  it is a defining property of boundary operators that 
  
    
      
        ∂
        ∘
        ∂
        ≡
        0
      
    
    {\displaystyle \partial \circ \partial \equiv 0}
  . in more axiomatic definitions one can find the requirement that 
  
    
      
        ∀
        σ
        ,
        
          τ
          
            ′
          
        
        ∈
        
          
            x
          
        
      
    
    {\displaystyle \forall \sigma ,\tau ^{\prime }\in {\mathcal {x}}}
  

  
    
      
        
          ∑
          
            τ
            ∈
            
              
                x
              
            
          
        
        κ
        (
        σ
        ,
        τ
        )
        κ
        (
        τ
        ,
        
          τ
          
            ′
          
        
        )
        =
        0
      
    
    {\displaystyle \sum _{\tau \in {\mathcal {x}}}\kappa (\sigma ,\tau )\kappa (\tau ,\tau ^{\prime })=0}
  which is a consequence of the above definition of the boundary operator and the requirement that 
  
    
      
        ∂
        ∘
        ∂
        ≡
        0
      
    
    {\displaystyle \partial \circ \partial \equiv 0}
  .


== discrete morse functions ==
a real-valued function 
  
    
      
        μ
        :
        
          
            x
          
        
        →
        
          r
        
      
    
    {\displaystyle \mu :{\mathcal {x}}\to \mathbb {r} }
   is a discrete morse function if it satisfies the following two properties:

for any cell 
  
    
      
        σ
        ∈
        
          
            x
          
        
      
    
    {\displaystyle \sigma \in {\mathcal {x}}}
  , the number of cells 
  
    
      
        τ
        ∈
        
          
            x
          
        
      
    
    {\displaystyle \tau \in {\mathcal {x}}}
   in the boundary of 
  
    
      
        σ
      
    
    {\displaystyle \sigma }
   which satisfy 
  
    
      
        μ
        (
        σ
        )
        ≤
        μ
        (
        τ
        )
      
    
    {\displaystyle \mu (\sigma )\leq \mu (\tau )}
   is at most one.
for any cell 
  
    
      
        σ
        ∈
        
          
            x
          
        
      
    
    {\displaystyle \sigma \in {\mathcal {x}}}
  , the number of cells 
  
    
      
        τ
        ∈
        
          
            x
          
        
      
    
    {\displaystyle \tau \in {\mathcal {x}}}
   containing 
  
    
      
        σ
      
    
    {\displaystyle \sigma }
   in their boundary which satisfy 
  
    
      
        μ
        (
        σ
        )
        ≥
        μ
        (
        τ
        )
      
    
    {\displaystyle \mu (\sigma )\geq \mu (\tau )}
   is at most one.it can be shown that the cardinalities in the two conditions cannot both be one simultaneously for a fixed cell 
  
    
      
        σ
      
    
    {\displaystyle \sigma }
  , provided that 
  
    
      
        
          
            x
          
        
      
    
    {\displaystyle {\mathcal {x}}}
   is a regular cw complex. in this case, each cell 
  
    
      
        σ
        ∈
        
          
            x
          
        
      
    
    {\displaystyle \sigma \in {\mathcal {x}}}
   can be paired with at most one exceptional cell 
  
    
      
        τ
        ∈
        
          
            x
          
        
      
    
    {\displaystyle \tau \in {\mathcal {x}}}
  : either a boundary cell with larger 
  
    
      
        μ
      
    
    {\displaystyle \mu }
   value, or a co-boundary cell with smaller 
  
    
      
        μ
      
    
    {\displaystyle \mu }
   value. the cells which have no pairs, i.e., whose function values are strictly higher than their boundary cells and strictly lower than their co-boundary cells are called critical cells. thus, a discrete morse function partitions the cw complex into three distinct cell collections: 
  
    
      
        
          
            x
          
        
        =
        
          
            a
          
        
        ⊔
        
          
            k
          
        
        ⊔
        
          
            q
          
        
      
    
    {\displaystyle {\mathcal {x}}={\mathcal {a}}\sqcup {\mathcal {k}}\sqcup {\mathcal {q}}}
  , where:

  
    
      
        
          
            a
          
        
      
    
    {\displaystyle {\mathcal {a}}}
   denotes the critical cells which are unpaired,

  
    
      
        
          
            k
          
        
      
    
    {\displaystyle {\mathcal {k}}}
   denotes cells which are paired with boundary cells, and

  
    
      
        
          
            q
          
        
      
    
    {\displaystyle {\mathcal {q}}}
   denotes cells which are paired with co-boundary cells.by construction, there is a bijection of sets between 
  
    
      
        k
      
    
    {\displaystyle k}
  -dimensional cells in 
  
    
      
        
          
            k
          
        
      
    
    {\displaystyle {\mathcal {k}}}
   and the 
  
    
      
        (
        k
        −
        1
        )
      
    
    {\displaystyle (k-1)}
  -dimensional cells in 
  
    
      
        
          
            q
          
        
      
    
    {\displaystyle {\mathcal {q}}}
  , which can be denoted by 
  
    
      
        
          p
          
            k
          
        
        :
        
          
            
              k
            
          
          
            k
          
        
        →
        
          
            
              q
            
          
          
            k
            −
            1
          
        
      
    
    {\displaystyle p^{k}:{\mathcal {k}}^{k}\to {\mathcal {q}}^{k-1}}
   for each natural number 
  
    
      
        k
      
    
    {\displaystyle k}
  . it is an additional technical requirement that for each 
  
    
      
        k
        ∈
        
          
            
              k
            
          
          
            k
          
        
      
    
    {\displaystyle k\in {\mathcal {k}}^{k}}
  , the degree of the attaching map from the boundary of 
  
    
      
        k
      
    
    {\displaystyle k}
   to its paired cell 
  
    
      
        
          p
          
            k
          
        
        (
        k
        )
        ∈
        
          
            q
          
        
      
    
    {\displaystyle p^{k}(k)\in {\mathcal {q}}}
   is a unit in the underlying ring of 
  
    
      
        
          
            x
          
        
      
    
    {\displaystyle {\mathcal {x}}}
  . for instance, over the integers 
  
    
      
        
          z
        
      
    
    {\displaystyle \mathbb {z} }
  , the only allowed values are 
  
    
      
        ±
        1
      
    
    {\displaystyle \pm 1}
  . this technical requirement is guaranteed, for instance, when one assumes that 
  
    
      
        
          
            x
          
        
      
    
    {\displaystyle {\mathcal {x}}}
   is a regular cw complex over 
  
    
      
        
          z
        
      
    
    {\displaystyle \mathbb {z} }
  .
the fundamental result of discrete morse theory establishes that the cw complex 
  
    
      
        
          
            x
          
        
      
    
    {\displaystyle {\mathcal {x}}}
   is isomorphic on the level of homology to a new complex 
  
    
      
        
          
            a
          
        
      
    
    {\displaystyle {\mathcal {a}}}
   consisting of only the critical cells. the paired cells in 
  
    
      
        
          
            k
          
        
      
    
    {\displaystyle {\mathcal {k}}}
   and 
  
    
      
        
          
            q
          
        
      
    
    {\displaystyle {\mathcal {q}}}
   describe gradient paths between adjacent critical cells which can be used to obtain the boundary operator on 
  
    
      
        
          
            a
          
        
      
    
    {\displaystyle {\mathcal {a}}}
  . some details of this construction are provided in the next section.


== the morse complex ==
a gradient path is a sequence of paired cells

  
    
      
        ρ
        =
        (
        
          q
          
            1
          
        
        ,
        
          k
          
            1
          
        
        ,
        
          q
          
            2
          
        
        ,
        
          k
          
            2
          
        
        ,
        …
        ,
        
          q
          
            m
          
        
        ,
        
          k
          
            m
          
        
        )
      
    
    {\displaystyle \rho =(q_{1},k_{1},q_{2},k_{2},\ldots ,q_{m},k_{m})}
  satisfying 
  
    
      
        
          q
          
            m
          
        
        =
        p
        (
        
          k
          
            m
          
        
        )
      
    
    {\displaystyle q_{m}=p(k_{m})}
   and 
  
    
      
        κ
        (
        
          k
          
            m
          
        
        ,
         
        
          q
          
            m
            +
            1
          
        
        )
        ≠
        0
      
    
    {\displaystyle \kappa (k_{m},~q_{m+1})\neq 0}
  . the index of this gradient path is defined to be the integer

  
    
      
        ν
        (
        ρ
        )
        =
        
          
            
              
                ∏
                
                  m
                  =
                  1
                
                
                  m
                  −
                  1
                
              
              −
              κ
              (
              
                k
                
                  m
                
              
              ,
              
                q
                
                  m
                  +
                  1
                
              
              )
            
            
              
                ∏
                
                  m
                  =
                  1
                
                
                  m
                
              
              κ
              (
              
                k
                
                  m
                
              
              ,
              
                q
                
                  m
                
              
              )
            
          
        
        .
      
    
    {\displaystyle \nu (\rho )={\frac {\prod _{m=1}^{m-1}-\kappa (k_{m},q_{m+1})}{\prod _{m=1}^{m}\kappa (k_{m},q_{m})}}.}
  the division here makes sense because the incidence between paired cells must be 
  
    
      
        ±
        1
      
    
    {\displaystyle \pm 1}
  . note that by construction, the values of the discrete morse function 
  
    
      
        μ
      
    
    {\displaystyle \mu }
   must decrease across 
  
    
      
        ρ
      
    
    {\displaystyle \rho }
  . the path 
  
    
      
        ρ
      
    
    {\displaystyle \rho }
   is said to connect two critical cells 
  
    
      
        a
        ,
        
          a
          ′
        
        ∈
        
          
            a
          
        
      
    
    {\displaystyle a,a'\in {\mathcal {a}}}
   if 
  
    
      
        κ
        (
        a
        ,
        
          q
          
            1
          
        
        )
        ≠
        0
        ≠
        κ
        (
        
          k
          
            m
          
        
        ,
        
          a
          ′
        
        )
      
    
    {\displaystyle \kappa (a,q_{1})\neq 0\neq \kappa (k_{m},a')}
  . this relationship may be expressed as 
  
    
      
        a
        
          
            
              
                →
              
              
                ρ
              
            
          
        
        
          a
          ′
        
      
    
    {\displaystyle a{\stackrel {\rho }{\to }}a'}
  . the multiplicity of this connection is defined to be the integer 
  
    
      
        m
        (
        ρ
        )
        =
        κ
        (
        a
        ,
        
          q
          
            1
          
        
        )
        ⋅
        ν
        (
        ρ
        )
        ⋅
        κ
        (
        
          k
          
            m
          
        
        ,
        
          a
          ′
        
        )
      
    
    {\displaystyle m(\rho )=\kappa (a,q_{1})\cdot \nu (\rho )\cdot \kappa (k_{m},a')}
  . finally, the morse boundary operator on the critical cells 
  
    
      
        
          
            a
          
        
      
    
    {\displaystyle {\mathcal {a}}}
   is defined by

  
    
      
        δ
        (
        a
        )
        =
        κ
        (
        a
        ,
        
          a
          ′
        
        )
        +
        
          ∑
          
            a
            
              
                
                  
                    →
                  
                  
                    ρ
                  
                
              
            
            
              a
              ′
            
          
        
        m
        (
        ρ
        )
        
          a
          ′
        
      
    
    {\displaystyle \delta (a)=\kappa (a,a')+\sum _{a{\stackrel {\rho }{\to }}a'}m(\rho )a'}
  where the sum is taken over all gradient path connections from 
  
    
      
        a
      
    
    {\displaystyle a}
   to 
  
    
      
        
          a
          ′
        
      
    
    {\displaystyle a'}
  .


== basic results ==
many of the familiar results from continuous morse theory apply in the discrete setting.


=== the morse inequalities ===
let 
  
    
      
        
          
            a
          
        
      
    
    {\displaystyle {\mathcal {a}}}
   be a morse complex associated to the cw complex 
  
    
      
        
          
            x
          
        
      
    
    {\displaystyle {\mathcal {x}}}
  . the number 
  
    
      
        
          m
          
            q
          
        
        =
        
          |
        
        
          
            
              a
            
          
          
            q
          
        
        
          |
        
      
    
    {\displaystyle m_{q}=|{\mathcal {a}}_{q}|}
   of 
  
    
      
        q
      
    
    {\displaystyle q}
  -cells in 
  
    
      
        
          
            a
          
        
      
    
    {\displaystyle {\mathcal {a}}}
   is called the 
  
    
      
        q
      
    
    {\displaystyle q}
  -th morse number. let 
  
    
      
        
          β
          
            q
          
        
      
    
    {\displaystyle \beta _{q}}
   denote the 
  
    
      
        q
      
    
    {\displaystyle q}
  -th betti number of 
  
    
      
        
          
            x
          
        
      
    
    {\displaystyle {\mathcal {x}}}
  . then, for any 
  
    
      
        n
        >
        0
      
    
    {\displaystyle n>0}
  , the following inequalities hold

  
    
      
        
          m
          
            n
          
        
        ≥
        
          β
          
            n
          
        
      
    
    {\displaystyle m_{n}\geq \beta _{n}}
  , and

  
    
      
        
          m
          
            n
          
        
        −
        
          m
          
            n
            −
            1
          
        
        +
        ⋯
        ±
        
          m
          
            0
          
        
        ≥
        
          β
          
            n
          
        
        −
        
          β
          
            n
            −
            1
          
        
        +
        ⋯
        ±
        
          β
          
            0
          
        
      
    
    {\displaystyle m_{n}-m_{n-1}+\dots \pm m_{0}\geq \beta _{n}-\beta _{n-1}+\dots \pm \beta _{0}}
  moreover, the euler characteristic 
  
    
      
        χ
        (
        
          
            x
          
        
        )
      
    
    {\displaystyle \chi ({\mathcal {x}})}
   of 
  
    
      
        
          
            x
          
        
      
    
    {\displaystyle {\mathcal {x}}}
   satisfies

  
    
      
        χ
        (
        
          
            x
          
        
        )
        =
        
          m
          
            0
          
        
        −
        
          m
          
            1
          
        
        +
        ⋯
        ±
        
          m
          
            dim
            ⁡
            
              
                x
              
            
          
        
      
    
    {\displaystyle \chi ({\mathcal {x}})=m_{0}-m_{1}+\dots \pm m_{\dim {\mathcal {x}}}}
  


=== discrete morse homology and homotopy type ===
let 
  
    
      
        
          
            x
          
        
      
    
    {\displaystyle {\mathcal {x}}}
   be a regular cw complex with boundary operator 
  
    
      
        ∂
      
    
    {\displaystyle \partial }
   and a discrete morse function 
  
    
      
        μ
        :
        
          
            x
          
        
        →
        
          r
        
      
    
    {\displaystyle \mu :{\mathcal {x}}\to \mathbb {r} }
  . let 
  
    
      
        
          
            a
          
        
      
    
    {\displaystyle {\mathcal {a}}}
   be the associated morse complex with morse boundary operator 
  
    
      
        δ
      
    
    {\displaystyle \delta }
  . then, there is an isomorphism of homology groups

  
    
      
        
          h
          
            ∗
          
        
        (
        
          
            x
          
        
        ,
        ∂
        )
        ≃
        
          h
          
            ∗
          
        
        (
        
          
            a
          
        
        ,
        δ
        )
        ,
      
    
    {\displaystyle h_{*}({\mathcal {x}},\partial )\simeq h_{*}({\mathcal {a}},\delta ),}
  and similarly for the homotopy groups.


== applications ==
discrete morse theory finds its application in molecular shape analysis, skeletonization of digital images/volumes, graph reconstruction from noisy data and denoising noisy point clouds.


== see also ==
digital morse theory
stratified morse theory
shape analysis
topological combinatorics
discrete differential geometry


== references ==

forman, robin (2002). "a user's guide to discrete morse theory" (pdf). séminaire lotharingien de combinatoire. 48: art. b48c, 35 pp. mr 1939695.
kozlov, dmitry (2007). combinatorial algebraic topology. algorithms and computation in mathematics. vol. 21. berlin: springer. isbn 978-3540719618. mr 2361455.
jonsson, jakob (2007). simplicial complexes of graphs. springer. isbn 978-3540758587.
orlik, peter; welker, volkmar (2007). algebraic combinatorics: lectures at a summer school in nordfjordeid. universitext. springer. doi:10.1007/978-3-540-68376-6. isbn 978-3540683759. mr 2322081.
"discrete morse theory". nlab.